<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸå­å½ˆåŸç†ï¼šäº’å‹•å¼æ·±åº¦è§£æ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans TC', 'Noto Sans JP', sans-serif; /* Prioritize TC, then JP, then generic sans-serif */
            background-color: #F8F7F4;
            color: #333333;
        }
        .nav-link {
            transition: all 0.3s ease;
            color: #6b7280;
        }
        .nav-link.active, .nav-link:hover {
            color: #B85C5C;
            transform: translateX(5px);
        }
        .section-card {
            background-color: #FFFFFF;
            border: 1px solid #E5E7EB;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 40vh;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .btn-primary {
            background-color: #5C85B8;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #4a6a93;
        }
        .btn-secondary {
            background-color: #e0e0e0;
            color: #333;
            transition: background-color 0.3s ease;
        }
        .btn-secondary.active {
            background-color: #B85C5C;
            color: white;
        }
        .gun-piece {
            transition: transform 1s ease-in-out;
        }
        .implosion-segment {
            transition: all 0.8s ease-in-out;
        }
        /* Language selector styling */
        .lang-selector {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 100;
        }
        .lang-selector select {
            background-color: #FFFFFF;
            border: 1px solid #E5E7EB;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            cursor: pointer;
            outline: none;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            -webkit-appearance: none; /* Remove default arrow on select */
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem; /* Make space for custom arrow */
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Language Selector -->
    <div class="lang-selector">
        <select id="language-switcher">
            <option value="zh-Hant">ä¸­æ–‡ (ç¹é«”)</option>
            <option value="ja">æ—¥æœ¬èª</option>
        </select>
    </div>

    <div class="flex">
        <!-- Side Navigation -->
        <nav id="side-nav" class="hidden lg:block fixed top-0 left-0 h-screen w-64 bg-white/80 backdrop-blur-sm p-8 shadow-lg">
            <h2 class="text-xl font-bold text-gray-800 mb-8" data-i18n="navTitle">å°è¦½</h2>
            <ul class="space-y-4">
                <li><a href="#intro" class="nav-link font-medium" data-i18n="navIntro">åºç« ï¼šæ ¸å¿ƒå¥§ç§˜</a></li>
                <li><a href="#principle" class="nav-link font-medium" data-i18n="navPrinciple">ç¬¬ä¸€ç« ï¼šæ ¸åˆ†è£‚åŸç†</a></li>
                <li><a href="#chain-reaction" class="nav-link font-medium" data-i18n="navChainReaction">ç¬¬äºŒç« ï¼šé€£é–åæ‡‰</a></li>
                <li><a href="#design" class="nav-link font-medium" data-i18n="navDesign">ç¬¬ä¸‰ç« ï¼šå·¥ç¨‹è¨­è¨ˆ</a></li>
                <li><a href="#power" class="nav-link font-medium" data-i18n="navPower">ç¬¬å››ç« ï¼šå¨åŠ›ä¹‹æº</a></li>
                <li><a href="#effects" class="nav-link font-medium" data-i18n="navEffects">ç¬¬äº”ç« ï¼šæ¯€æ»…æ•ˆæ‡‰</a></li>
                <li><a href="#conclusion" class="nav-link font-medium" data-i18n="navConclusion">çµ‚ç« ï¼šç§‘å­¸èˆ‡è²¬ä»»</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="w-full lg:ml-64 p-4 md:p-8 lg:p-12">
            <div class="max-w-4xl mx-auto">

                <!-- Section: Introduction -->
                <section id="intro" class="min-h-screen flex flex-col justify-center text-center py-16">
                    <h1 class="text-4xl md:text-6xl font-bold text-gray-800 mb-4" data-i18n="introTitle">åŸå­å½ˆ</h1>
                    <p class="text-lg md:text-xl text-gray-600 mb-8" data-i18n="introSubtitle">ä¸€å ´æ”¹è®Šä¸–ç•Œçš„ç§‘å­¸é©å‘½ï¼Œæ­ç¤ºç‰©è³ªæ·±è™•çš„å·¨å¤§èƒ½é‡</p>
                    <div class="section-card p-8">
                        <h2 class="text-2xl font-bold text-[#B85C5C] mb-4" data-i18n="introSectionTitle">æ ¸å¿ƒå¥§ç§˜</h2>
                        <p class="text-base md:text-lg text-left leading-relaxed" data-i18n="introContent">åŸå­å½ˆï¼Œä¸€ç¨®åˆ©ç”¨æ ¸åˆ†è£‚é€£é–åæ‡‰åœ¨ç¬é–“é‡‹æ”¾ç„¡çª®èƒ½é‡çš„æ­¦å™¨ï¼Œå…¶èª•ç”Ÿä¸åƒ…æ˜¯20ä¸–ç´€çš„ç§‘æŠ€å·”å³°ï¼Œä¹Ÿå¾¹åº•æ”¹è®Šäº†æˆ°çˆ­å½¢æ…‹å’Œåœ‹éš›æ ¼å±€ã€‚æœ¬äº’å‹•å ±å‘Šå°‡å¼•å°æ‚¨å±¤å±¤æ·±å…¥ï¼Œå¾å¾®è§€çš„åŸå­æ ¸åˆ°å®è§€çš„æ¯€æ»…åŠ›é‡ï¼Œå…¨é¢è§£æåŸå­å½ˆçš„ç§‘å­¸åŸç†ã€å·¥ç¨‹æŒ‘æˆ°åŠå…¶é©šäººå¨åŠ›çš„æ ¹æºã€‚</p>
                    </div>
                </section>

                <!-- Section: Principle of Fission -->
                <section id="principle" class="py-16 md:py-24">
                    <h2 class="text-3xl font-bold text-center mb-12" data-i18n="principleTitle">ç¬¬ä¸€ç« ï¼šæ ¸åˆ†è£‚åŸç†</h2>
                    <p class="text-center text-gray-600 mb-12 max-w-3xl mx-auto" data-i18n="principleDescription">ä¸€åˆ‡å§‹æ–¼åŸå­æ ¸çš„åˆ†è£‚ã€‚åŸå­å½ˆçš„åŸºç¤æ˜¯ä¸€ç¨®ç¨±ç‚ºã€Œæ ¸åˆ†è£‚ã€çš„ç‰©ç†ç¾è±¡ï¼šç•¶ä¸€å€‹ä¸­å­æ’æ“Šä¸€å€‹é‡åŸå­æ ¸ï¼ˆå¦‚éˆ¾-235ï¼‰ï¼Œè©²åŸå­æ ¸æœƒåˆ†è£‚æˆå…©å€‹è¼ƒè¼•çš„åŸå­ï¼ŒåŒæ™‚é‡‹æ”¾å‡ºèƒ½é‡å’Œæ›´å¤šçš„ä¸­å­ï¼Œç‚ºé€£é–åæ‡‰æä¾›äº†å¯èƒ½ã€‚</p>
                    <div class="section-card p-6 md:p-8">
                        <h3 class="text-2xl font-bold text-center mb-6" data-i18n="principleKeyRawMaterialTitle">é—œéµåŸæ–™ï¼šéˆ¾-235 vs éˆ¾-238</h3>
                        <p class="text-center text-gray-600 mb-8" data-i18n="principleKeyRawMaterialDescription">ä¸¦éæ‰€æœ‰éˆ¾éƒ½èƒ½è¼•æ˜“åˆ†è£‚ã€‚è‡ªç„¶ç•Œçš„éˆ¾ç¤¦ä¸­ï¼Œçµ•å¤§éƒ¨åˆ†æ˜¯ç©©å®šçš„éˆ¾-238ï¼Œåªæœ‰ç´„0.7%æ˜¯æ˜“æ–¼åˆ†è£‚çš„éˆ¾-235ã€‚è£½é€ åŸå­å½ˆéœ€è¦å°‡éˆ¾-235çš„æ¿ƒåº¦æå‡è‡³90%ä»¥ä¸Šï¼Œé€™æ˜¯ä¸€å€‹æ¥µå…¶å›°é›£ä¸”è€—èƒ½çš„éç¨‹ã€‚</p>
                        <div class="chart-container">
                            <canvas id="uraniumPurityChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Section: Chain Reaction -->
                <section id="chain-reaction" class="py-16 md:py-24">
                    <h2 class="text-3xl font-bold text-center mb-12" data-i18n="chainReactionTitle">ç¬¬äºŒç« ï¼šå¤±æ§çš„é€£é–åæ‡‰</h2>
                    <p class="text-center text-gray-600 mb-12 max-w-3xl mx-auto" data-i18n="chainReactionDescription">åŸå­å½ˆå¨åŠ›çš„ç§˜è¨£åœ¨æ–¼ã€Œå¤±æ§ã€ã€‚ä¸€æ¬¡æ ¸åˆ†è£‚é‡‹æ”¾2åˆ°3å€‹ä¸­å­ï¼Œæ¯å€‹ä¸­å­åˆå¯èƒ½å¼•ç™¼æ–°çš„åˆ†è£‚ï¼Œå½¢æˆæŒ‡æ•¸ç´šå¢é•·çš„èƒ½é‡é‡‹æ”¾ã€‚åœ¨çŸ­çŸ­ä¸€å¾®ç§’å…§ï¼Œåˆ†è£‚çš„åŸå­æ•¸é‡å°±èƒ½ç¿»ä¸Šç™¾å€ï¼Œç”¢ç”Ÿå¤©æ–‡æ•¸å­—èˆ¬çš„èƒ½é‡ã€‚</p>
                    <div class="section-card p-6 md:p-8">
                        <h3 class="text-2xl font-bold text-center mb-6" data-i18n="chainReactionSimulationTitle">äº’å‹•æ¨¡æ“¬ï¼šå•Ÿå‹•é€£é–åæ‡‰</h3>
                        <div class="bg-gray-100 rounded-lg h-64 w-full relative mb-4 overflow-hidden">
                            <canvas id="chainReactionCanvas"></canvas>
                        </div>
                        <div class="text-center">
                            <button id="startReactionBtn" class="btn-primary font-bold py-2 px-6 rounded-lg" data-i18n="startReactionBtn">å•Ÿå‹•åæ‡‰</button>
                            <p class="mt-4" data-i18n="fissionCountText">å·²åˆ†è£‚åŸå­æ ¸æ•¸é‡: <span id="fission-count" class="font-bold text-xl text-[#B85C5C]">0</span></p>
                        </div>
                    </div>
                </section>

                <!-- Section: Bomb Design -->
                <section id="design" class="py-16 md:py-24">
                    <h2 class="text-3xl font-bold text-center mb-12" data-i18n="designTitle">ç¬¬ä¸‰ç« ï¼šå…©ç¨®å·¥ç¨‹è¨­è¨ˆ</h2>
                    <p class="text-center text-gray-600 mb-12 max-w-3xl mx-auto" data-i18n="designDescription">ç‚ºäº†å¼•ç™¼é€£é–åæ‡‰ï¼Œå¿…é ˆåœ¨ç¬é–“å°‡è¶³å¤ çš„æ ¸ææ–™ï¼ˆé”åˆ°ã€Œè‡¨ç•Œè³ªé‡ã€ï¼‰èšé›†åœ¨ä¸€èµ·ã€‚æ­·å²ä¸Šä¸»è¦æœ‰å…©ç¨®å¯¦ç¾æ–¹å¼ï¼šæ§å¼å’Œå…§çˆ†å¼ã€‚é€™å…©ç¨®è¨­è¨ˆä»£è¡¨äº†å°‡ç‰©ç†ç†è«–è½‰åŒ–ç‚ºå·¥ç¨‹ç¾å¯¦çš„å·¨å¤§æŒ‘æˆ°ã€‚</p>
                    <div class="section-card p-6 md:p-8">
                        <div class="flex justify-center mb-6 space-x-4">
                            <button id="gun-btn" class="btn-secondary font-bold py-2 px-6 rounded-lg active" data-i18n="gunBtn">æ§å¼è¨­è¨ˆ</button>
                            <button id="implosion-btn" class="btn-secondary font-bold py-2 px-6 rounded-lg" data-i18n="implosionBtn">å…§çˆ†å¼è¨­è¨ˆ</button>
                        </div>
                        
                        <div id="design-display">
                            <!-- Content will be injected by JavaScript -->
                        </div>
                    </div>
                </section>

                <!-- Section: Power Source (E=mc^2) -->
                <section id="power" class="py-16 md:py-24">
                    <h2 class="text-3xl font-bold text-center mb-12" data-i18n="powerTitle">ç¬¬å››ç« ï¼šå¨åŠ›ä¹‹æº E=mcÂ²</h2>
                     <p class="text-center text-gray-600 mb-12 max-w-3xl mx-auto" data-i18n="powerDescription">åŸå­å½ˆçš„é©šäººå¨åŠ›ï¼Œæœ€çµ‚å¯è¿½æº¯è‡³æ„›å› æ–¯å¦çš„è³ªèƒ½ç­‰åƒ¹å…¬å¼ E=mcÂ²ã€‚åœ¨æ ¸åˆ†è£‚ä¸­ï¼Œç”¢ç‰©çš„ç¸½è³ªé‡æœƒæ¯”åæ‡‰å‰ç•¥å¾®æ¸›å°‘ï¼Œé€™ã€Œæ¶ˆå¤±ã€çš„å¾®å°è³ªé‡ï¼Œä¹˜ä»¥å…‰é€Ÿçš„å¹³æ–¹ï¼Œè½‰åŒ–æˆäº†å·¨å¤§çš„èƒ½é‡ã€‚é€™ä¹Ÿæ˜¯æ ¸åæ‡‰èˆ‡åŒ–å­¸åæ‡‰åœ¨èƒ½é‡ç´šåˆ¥ä¸Šçš„æ ¹æœ¬å€åˆ¥ã€‚</p>
                    <div class="section-card p-6 md:p-8">
                         <h3 class="text-2xl font-bold text-center mb-6" data-i18n="energyComparisonTitle">èƒ½é‡å°æ¯”ï¼šæ ¸åæ‡‰ vs. åŒ–å­¸åæ‡‰</h3>
                         <p class="text-center text-gray-600 mb-8" data-i18n="energyComparisonDescription">1å…¬æ–¤çš„éˆ¾å®Œå…¨è£‚è®Šæ‰€é‡‹æ”¾çš„èƒ½é‡ï¼Œç´„ç­‰æ–¼2è¬å™¸TNTç‚¸è—¥ã€‚ä¸‹åœ–ç›´è§€åœ°å±•ç¤ºäº†é€™é›£ä»¥æƒ³åƒçš„å·®è·ã€‚</p>
                         <div class="chart-container">
                            <canvas id="energyComparisonChart"></canvas>
                        </div>
                    </div>
                </section>
                
                <!-- Section: Effects -->
                <section id="effects" class="py-16 md:py-24">
                    <h2 class="text-3xl font-bold text-center mb-12" data-i18n="effectsTitle">ç¬¬äº”ç« ï¼šå¤šé‡æ¯€æ»…æ•ˆæ‡‰</h2>
                    <p class="text-center text-gray-600 mb-12 max-w-3xl mx-auto" data-i18n="effectsDescription">åŸå­å½ˆçš„ç ´å£åŠ›æ˜¯å¤šå±¤æ¬¡ä¸”è¤‡åˆçš„ã€‚çˆ†ç‚¸ç¬é–“ç”¢ç”Ÿçš„èƒ½é‡ï¼Œä»¥å¤šç¨®å½¢å¼å°ç›®æ¨™å€åŸŸé€ æˆæ¯€æ»…æ€§æ‰“æ“Šï¼Œå…¶å½±éŸ¿å¾å³æ™‚çš„ç‰©ç†æ‘§æ¯€å»¶ä¼¸åˆ°é•·æœŸçš„ç’°å¢ƒèˆ‡ç”Ÿç‰©å±å®³ã€‚</p>
                    <div class="space-y-4">
                        <div class="effect-item">
                            <button class="effect-button w-full text-left p-4 rounded-lg bg-white shadow flex justify-between items-center">
                                <span class="font-bold text-lg" data-i18n="effectLightRadiationTitle">ğŸ”¥ å…‰è¼»å°„ (ç†±è¼»å°„)</span>
                                <span class="arrow text-2xl transform">â–¼</span>
                            </button>
                            <div class="effect-content hidden p-4 bg-gray-50 rounded-b-lg">
                                <p data-i18n="effectLightRadiationContent">ç´„35%èƒ½é‡ä»¥ç†±è¼»å°„é‡‹æ”¾ï¼Œä»¥å…‰é€Ÿå‚³æ’­ã€‚ä¸­å¿ƒæº«åº¦å¯é”æ•¸åè¬åº¦ï¼Œé€ æˆå¤§é¢ç©ç‡’å‚·ä¸¦å¼•ç‡ƒä¸€åˆ‡å¯ç‡ƒç‰©ã€‚</p>
                            </div>
                        </div>
                        <div class="effect-item">
                            <button class="effect-button w-full text-left p-4 rounded-lg bg-white shadow flex justify-between items-center">
                                <span class="font-bold text-lg" data-i18n="effectBlastWaveTitle">ğŸ’¨ è¡æ“Šæ³¢</span>
                                <span class="arrow text-2xl transform">â–¼</span>
                            </button>
                            <div class="effect-content hidden p-4 bg-gray-50 rounded-b-lg">
                                <p data-i18n="effectBlastWaveContent">å·¨å¤§çš„æ°£æµè¶…å£“ä»¥è¶…éŸ³é€Ÿå‘å¤–æ“´æ•£ï¼Œæ‘§æ¯€å»ºç¯‰ç‰©ã€æ©‹æ¨‘ç­‰æ‰€æœ‰åœ°é¢è¨­æ–½ã€‚ä¸€æš3è¬å™¸ç•¶é‡çš„åŸå­å½ˆï¼Œåœ¨800ç±³è™•çš„è¡æ“Šæ³¢é€Ÿåº¦ä»é«˜é”æ¯ç§’200ç±³ã€‚</p>
                            </div>
                        </div>
                        <div class="effect-item">
                            <button class="effect-button w-full text-left p-4 rounded-lg bg-white shadow flex justify-between items-center">
                                <span class="font-bold text-lg" data-i18n="effectEarlyRadiationTitle">â˜£ï¸ æ—©æœŸæ ¸è¼»å°„</span>
                                <span class="arrow text-2xl transform">â–¼</span>
                            </button>
                            <div class="effect-content hidden p-4 bg-gray-50 rounded-b-lg">
                                <p data-i18n="effectEarlyRadiationContent">çˆ†ç‚¸æœ€åˆå¹¾åç§’é‡‹æ”¾çš„é«˜èƒ½ä¸­å­æµå’Œä¼½é¦¬å°„ç·šï¼Œèƒ½ç©¿é€äººé«”ï¼Œç ´å£DNAï¼Œå°è‡´æ€¥æ€§è¼»å°„ç—…ç”šè‡³æ­»äº¡ã€‚</p>
                            </div>
                        </div>
                        <div class="effect-item">
                            <button class="effect-button w-full text-left p-4 rounded-lg bg-white shadow flex justify-between items-center">
                                <span class="font-bold text-lg" data-i18n="effectEMPTitle">âš¡ é›»ç£è„ˆè¡ (EMP)</span>
                                <span class="arrow text-2xl transform">â–¼</span>
                            </button>
                            <div class="effect-content hidden p-4 bg-gray-50 rounded-b-lg">
                                <p data-i18n="effectEMPContent">å¼·å¤§çš„é›»ç£è„ˆè¡èƒ½ç¬é–“æ‘§æ¯€å¤§ç¯„åœå…§çš„é›»å­è¨­å‚™ï¼Œå°è‡´é€šè¨Šä¸­æ–·ã€é›»ç¶²ç™±ç˜“ï¼Œä½¿ç¾ä»£ç¤¾æœƒé™·å…¥åœæ»¯ã€‚</p>
                            </div>
                        </div>
                        <div class="effect-item">
                            <button class="effect-button w-full text-left p-4 rounded-lg bg-white shadow flex justify-between items-center">
                                <span class="font-bold text-lg" data-i18n="effectFalloutTitle">ğŸŒ§ï¸ æ”¾å°„æ€§æ²¾æŸ“ (è¼»å°„å¡µ)</span>
                                <span class="arrow text-2xl transform">â–¼</span>
                            </button>
                            <div class="effect-content hidden p-4 bg-gray-50 rounded-b-lg">
                                <p data-i18n="effectFalloutContent">çˆ†ç‚¸ç”¢ç”Ÿçš„æ”¾å°„æ€§å¾®ç²’éš¨è•ˆç‹€é›²é£„æ•£ï¼Œæœ€çµ‚è½å›åœ°é¢ï¼Œé€ æˆé•·æœŸç’°å¢ƒæ±¡æŸ“ï¼Œå°ç”Ÿç‰©æ§‹æˆæŒçºŒçš„å¥åº·å¨è„…ã€‚</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section: Conclusion -->
                <section id="conclusion" class="py-16 md:py-24 text-center">
                     <h2 class="text-3xl font-bold mb-8" data-i18n="conclusionTitle">çµ‚ç« ï¼šç§‘å­¸ã€åŠ›é‡èˆ‡è²¬ä»»</h2>
                     <div class="section-card p-8">
                        <p class="text-base md:text-lg text-left leading-relaxed" data-i18n="conclusionContent">åŸå­å½ˆæ˜¯äººé¡æ™ºæ…§çš„çµæ™¶ï¼Œä¹Ÿæ˜¯æ‡¸æ–¼æ–‡æ˜é ­é ‚çš„é”æ‘©å…‹åˆ©æ–¯ä¹‹åŠã€‚å®ƒå®Œç¾æ¼”ç¹¹äº†æ ¸åˆ†è£‚é€£é–åæ‡‰èˆ‡è³ªèƒ½è½‰æ›çš„ç‰©ç†åŸç†ï¼Œä½†å…¶å¤šé‡æ¯€æ»…æ•ˆæ‡‰ä¹Ÿå±•ç¤ºäº†ç§‘å­¸åŠ›é‡å¤±æ§æ™‚çš„ææ€–å¾Œæœã€‚ç†è§£å…¶åŸç†ï¼Œä¸åƒ…æ˜¯ç‚ºäº†çŸ¥è­˜ï¼Œæ›´æ˜¯ç‚ºäº†é«”æœƒé€™ä»½åŠ›é‡èƒŒå¾Œçš„æ²‰é‡è²¬ä»»ï¼Œä¸¦åæ€äººé¡æ‡‰å¦‚ä½•å’Œå¹³åœ°å…±å­˜ï¼Œè² è²¬ä»»åœ°é‹ç”¨æ”¹è®Šä¸–ç•Œçš„åŠ›é‡ã€‚</p>
                     </div>
                </section>
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- Internationalization (i18n) Logic ---
    const languageSwitcher = document.getElementById('language-switcher');
    let currentChartUranium, currentChartEnergy; // Store chart instances to destroy/recreate

    const translations = {
        'zh-Hant': {
            // Document Title
            documentTitle: 'åŸå­å½ˆåŸç†ï¼šäº’å‹•å¼æ·±åº¦è§£æ',

            // Navigation
            navTitle: 'å°è¦½',
            navIntro: 'åºç« ï¼šæ ¸å¿ƒå¥§ç§˜',
            navPrinciple: 'ç¬¬ä¸€ç« ï¼šæ ¸åˆ†è£‚åŸç†',
            navChainReaction: 'ç¬¬äºŒç« ï¼šé€£é–åæ‡‰',
            navDesign: 'ç¬¬ä¸‰ç« ï¼šå·¥ç¨‹è¨­è¨ˆ',
            navPower: 'ç¬¬å››ç« ï¼šå¨åŠ›ä¹‹æº',
            navEffects: 'ç¬¬äº”ç« ï¼šæ¯€æ»…æ•ˆæ‡‰',
            navConclusion: 'çµ‚ç« ï¼šç§‘å­¸èˆ‡è²¬ä»»',

            // Intro Section
            introTitle: 'åŸå­å½ˆ',
            introSubtitle: 'ä¸€å ´æ”¹è®Šä¸–ç•Œçš„ç§‘å­¸é©å‘½ï¼Œæ­ç¤ºç‰©è³ªæ·±è™•çš„å·¨å¤§èƒ½é‡',
            introSectionTitle: 'æ ¸å¿ƒå¥§ç§˜',
            introContent: 'åŸå­å½ˆï¼Œä¸€ç¨®åˆ©ç”¨æ ¸åˆ†è£‚é€£é–åæ‡‰åœ¨ç¬é–“é‡‹æ”¾ç„¡çª®èƒ½é‡çš„æ­¦å™¨ï¼Œå…¶èª•ç”Ÿä¸åƒ…æ˜¯20ä¸–ç´€çš„ç§‘æŠ€å·”å³°ï¼Œä¹Ÿå¾¹åº•æ”¹è®Šäº†æˆ°çˆ­å½¢æ…‹å’Œåœ‹éš›æ ¼å±€ã€‚æœ¬äº’å‹•å ±å‘Šå°‡å¼•å°æ‚¨å±¤å±¤æ·±å…¥ï¼Œå¾å¾®è§€çš„åŸå­æ ¸åˆ°å®è§€çš„æ¯€æ»…åŠ›é‡ï¼Œå…¨é¢è§£æåŸå­å½ˆçš„ç§‘å­¸åŸç†ã€å·¥ç¨‹æŒ‘æˆ°åŠå…¶é©šäººå¨åŠ›çš„æ ¹æºã€‚',

            // Principle Section
            principleTitle: 'ç¬¬ä¸€ç« ï¼šæ ¸åˆ†è£‚åŸç†',
            principleDescription: 'ä¸€åˆ‡å§‹æ–¼åŸå­æ ¸çš„åˆ†è£‚ã€‚åŸå­å½ˆçš„åŸºç¤æ˜¯ä¸€ç¨®ç¨±ç‚ºã€Œæ ¸åˆ†è£‚ã€çš„ç‰©ç†ç¾è±¡ï¼šç•¶ä¸€å€‹ä¸­å­æ’æ“Šä¸€å€‹é‡åŸå­æ ¸ï¼ˆå¦‚éˆ¾-235ï¼‰ï¼Œè©²åŸå­æ ¸æœƒåˆ†è£‚æˆå…©å€‹è¼ƒè¼•çš„åŸå­ï¼ŒåŒæ™‚é‡‹æ”¾å‡ºèƒ½é‡å’Œæ›´å¤šçš„ä¸­å­ï¼Œç‚ºé€£é–åæ‡‰æä¾›äº†å¯èƒ½ã€‚',
            principleKeyRawMaterialTitle: 'é—œéµåŸæ–™ï¼šéˆ¾-235 vs éˆ¾-238',
            principleKeyRawMaterialDescription: 'ä¸¦éæ‰€æœ‰éˆ¾éƒ½èƒ½è¼•æ˜“åˆ†è£‚ã€‚è‡ªç„¶ç•Œçš„éˆ¾ç¤¦ä¸­ï¼Œçµ•å¤§éƒ¨åˆ†æ˜¯ç©©å®šçš„éˆ¾-238ï¼Œåªæœ‰ç´„0.7%æ˜¯æ˜“æ–¼åˆ†è£‚çš„éˆ¾-235ã€‚è£½é€ åŸå­å½ˆéœ€è¦å°‡éˆ¾-235çš„æ¿ƒåº¦æå‡è‡³90%ä»¥ä¸Šï¼Œé€™æ˜¯ä¸€å€‹æ¥µå…¶å›°é›£ä¸”è€—èƒ½çš„éç¨‹ã€‚',
            uraniumChartTitle: 'å¤©ç„¶éˆ¾ vs. æ­¦å™¨ç´šéˆ¾',
            uraniumChartLabelNaturalU238: 'éˆ¾-238 (å¤©ç„¶å æ¯”)',
            uraniumChartLabelNaturalU235: 'éˆ¾-235 (å¤©ç„¶å æ¯”)',
            uraniumChartLabelWeaponGrade: 'æ­¦å™¨ç´šéˆ¾-235æ‰€éœ€æ¿ƒåº¦',
            uraniumTooltipLabel: (context) => {
                let label = context.dataset.label || '';
                if (label) { label += ': '; }
                if (context.parsed !== null) { label += context.parsed + '%'; }
                return label;
            },


            // Chain Reaction Section
            chainReactionTitle: 'ç¬¬äºŒç« ï¼šå¤±æ§çš„é€£é–åæ‡‰',
            chainReactionDescription: 'åŸå­å½ˆå¨åŠ›çš„ç§˜è¨£åœ¨æ–¼ã€Œå¤±æ§ã€ã€‚ä¸€æ¬¡æ ¸åˆ†è£‚é‡‹æ”¾2åˆ°3å€‹ä¸­å­ï¼Œæ¯å€‹ä¸­å­åˆå¯èƒ½å¼•ç™¼æ–°çš„åˆ†è£‚ï¼Œå½¢æˆæŒ‡æ•¸ç´šå¢é•·çš„èƒ½é‡é‡‹æ”¾ã€‚åœ¨çŸ­çŸ­ä¸€å¾®ç§’å…§ï¼Œåˆ†è£‚çš„åŸå­æ•¸é‡å°±èƒ½ç¿»ä¸Šç™¾å€ï¼Œç”¢ç”Ÿå¤©æ–‡æ•¸å­—èˆ¬çš„èƒ½é‡ã€‚',
            chainReactionSimulationTitle: 'äº’å‹•æ¨¡æ“¬ï¼šå•Ÿå‹•é€£é–åæ‡‰',
            startReactionBtn: 'å•Ÿå‹•åæ‡‰',
            fissionCountText: 'å·²åˆ†è£‚åŸå­æ ¸æ•¸é‡:',

            // Design Section
            designTitle: 'ç¬¬ä¸‰ç« ï¼šå…©ç¨®å·¥ç¨‹è¨­è¨ˆ',
            designDescription: 'ç‚ºäº†å¼•ç™¼é€£é–åæ‡‰ï¼Œå¿…é ˆåœ¨ç¬é–“å°‡è¶³å¤ çš„æ ¸ææ–™ï¼ˆé”åˆ°ã€Œè‡¨ç•Œè³ªé‡ã€ï¼‰èšé›†åœ¨ä¸€èµ·ã€‚æ­·å²ä¸Šä¸»è¦æœ‰å…©ç¨®å¯¦ç¾æ–¹å¼ï¼šæ§å¼å’Œå…§çˆ†å¼ã€‚é€™å…©ç¨®è¨­è¨ˆä»£è¡¨äº†å°‡ç‰©ç†ç†è«–è½‰åŒ–ç‚ºå·¥ç¨‹ç¾å¯¦çš„å·¨å¤§æŒ‘æˆ°ã€‚',
            gunBtn: 'æ§å¼è¨­è¨ˆ',
            implosionBtn: 'å…§çˆ†å¼è¨­è¨ˆ',
            designGun: {
                title: 'æ§å¼è¨­è¨ˆ (Gun-Type)',
                description: 'çµæ§‹ç›¸å°ç°¡å–®ï¼Œé¡ä¼¼ç ²ç®¡ã€‚å°‡å…©å¡Šæ¬¡è‡¨ç•Œè³ªé‡çš„éˆ¾-235åˆ†é–‹æ”¾ç½®ï¼Œå¼•çˆ†æ™‚ç”¨å¸¸è¦ç‚¸è—¥å°‡ä¸€å¡Šã€Œå°„å‘ã€å¦ä¸€å¡Šï¼Œç¬é–“åˆä½µæˆè¶…è‡¨ç•Œè³ªé‡ï¼Œå¼•ç™¼çˆ†ç‚¸ã€‚',
                example: 'å¯¦ä¾‹ï¼šæŠ•æ“²æ–¼å»£å³¶çš„ã€Œå°ç”·å­©ã€(Little Boy)ã€‚',
                pros: 'å„ªé»ï¼šæ§‹é€ å–®ç´”ï¼Œå¯é æ€§é«˜ã€‚',
                cons: 'ç¼ºé»ï¼šæ•ˆç‡ä½ä¸‹ï¼ˆç‡ƒæ–™åˆ©ç”¨ç‡åƒ…ç´„2%ï¼‰ï¼Œå®‰å…¨æ€§è¼ƒå·®ï¼Œä¸”åªèƒ½ä½¿ç”¨éˆ¾ã€‚',
                triggerBtn: 'è§¸ç™¼æ¨¡æ“¬'
            },
            designImplosion: {
                title: 'å…§çˆ†å¼è¨­è¨ˆ (Implosion-Type)',
                description: 'çµæ§‹æ›´è¤‡é›œã€‚å°‡ä¸€å¡Šæ¬¡è‡¨ç•Œè³ªé‡çš„æ ¸ææ–™ï¼ˆéˆ½æˆ–éˆ¾ï¼‰ç½®æ–¼ä¸­å¿ƒï¼Œå¤–å±¤åŒ…è£¹çƒå½¢æ’åˆ—çš„å¸¸è¦ç‚¸è—¥ã€‚å¼•çˆ†æ™‚ï¼Œç‚¸è—¥åŒæ™‚å‘å…§çˆ†ç‚¸ï¼Œç”¢ç”Ÿå·¨å¤§å£“åŠ›å°‡æ ¸å¿ƒç¬é–“å£“ç¸®è‡³è¶…è‡¨ç•Œå¯†åº¦ã€‚',
                example: 'å¯¦ä¾‹ï¼šæŠ•æ“²æ–¼é•·å´çš„ã€Œèƒ–å­ã€(Fat Man)ã€‚',
                pros: 'å„ªé»ï¼šæ•ˆç‡é«˜å¾—å¤šï¼ˆç‡ƒæ–™åˆ©ç”¨ç‡ç´„17%ï¼‰ï¼Œå¯ä½¿ç”¨åæ‡‰æ›´å¼·çš„éˆ½ã€‚',
                cons: 'ç¼ºé»ï¼šçµæ§‹è¤‡é›œï¼Œå°ç‚¸è—¥åŒæ­¥å¼•çˆ†çš„è¦æ±‚æ¥µé«˜ã€‚',
                triggerBtn: 'è§¸ç™¼æ¨¡æ“¬'
            },

            // Power Section
            powerTitle: 'ç¬¬å››ç« ï¼šå¨åŠ›ä¹‹æº E=mcÂ²',
            powerDescription: 'åŸå­å½ˆçš„é©šäººå¨åŠ›ï¼Œæœ€çµ‚å¯è¿½æº¯è‡³æ„›å› æ–¯å¦çš„è³ªèƒ½ç­‰åƒ¹å…¬å¼ E=mcÂ²ã€‚åœ¨æ ¸åˆ†è£‚ä¸­ï¼Œç”¢ç‰©çš„ç¸½è³ªé‡æœƒæ¯”åæ‡‰å‰ç•¥å¾®æ¸›å°‘ï¼Œé€™ã€Œæ¶ˆå¤±ã€çš„å¾®å°è³ªé‡ï¼Œä¹˜ä»¥å…‰é€Ÿçš„å¹³æ–¹ï¼Œè½‰åŒ–æˆäº†å·¨å¤§çš„èƒ½é‡ã€‚é€™ä¹Ÿæ˜¯æ ¸åæ‡‰èˆ‡åŒ–å­¸åæ‡‰åœ¨èƒ½é‡ç´šåˆ¥ä¸Šçš„æ ¹æœ¬å€åˆ¥ã€‚',
            energyComparisonTitle: 'èƒ½é‡å°æ¯”ï¼šæ ¸åæ‡‰ vs. åŒ–å­¸åæ‡‰',
            energyComparisonDescription: '1å…¬æ–¤çš„éˆ¾å®Œå…¨è£‚è®Šæ‰€é‡‹æ”¾çš„èƒ½é‡ï¼Œç´„ç­‰æ–¼2è¬å™¸TNTç‚¸è—¥ã€‚ä¸‹åœ–ç›´è§€åœ°å±•ç¤ºäº†é€™é›£ä»¥æƒ³åƒçš„å·®è·ã€‚',
            energyChartLabel: 'é‡‹æ”¾èƒ½é‡ (ç­‰æ•ˆå™¸TNT)',
            energyChartXAxisTitle: 'TNTç•¶é‡ (å™¸) - å°æ•¸åº§æ¨™',
            energyChartLabelsKgTNT: '1å…¬æ–¤ TNT',
            energyChartLabelsKgU235: '1å…¬æ–¤ éˆ¾-235',
            energyTooltipLabel: (context) => {
                return `${context.dataset.label}: ${context.raw.toLocaleString()} å™¸ TNT ç•¶é‡`;
            },

            // Effects Section
            effectsTitle: 'ç¬¬äº”ç« ï¼šå¤šé‡æ¯€æ»…æ•ˆæ‡‰',
            effectsDescription: 'åŸå­å½ˆçš„ç ´å£åŠ›æ˜¯å¤šå±¤æ¬¡ä¸”è¤‡åˆçš„ã€‚çˆ†ç‚¸ç¬é–“ç”¢ç”Ÿçš„èƒ½é‡ï¼Œä»¥å¤šç¨®å½¢å¼å°ç›®æ¨™å€åŸŸé€ æˆæ¯€æ»…æ€§æ‰“æ“Šï¼Œå…¶å½±éŸ¿å¾å³æ™‚çš„ç‰©ç†æ‘§æ¯€å»¶ä¼¸åˆ°é•·æœŸçš„ç’°å¢ƒèˆ‡ç”Ÿç‰©å±å®³ã€‚',
            effectLightRadiationTitle: 'ğŸ”¥ å…‰è¼»å°„ (ç†±è¼»å°„)',
            effectLightRadiationContent: 'ç´„35%èƒ½é‡ä»¥ç†±è¼»å°„é‡‹æ”¾ï¼Œä»¥å…‰é€Ÿå‚³æ’­ã€‚ä¸­å¿ƒæº«åº¦å¯é”æ•¸åè¬åº¦ï¼Œé€ æˆå¤§é¢ç©ç‡’å‚·ä¸¦å¼•ç‡ƒä¸€åˆ‡å¯ç‡ƒç‰©ã€‚',
            effectBlastWaveTitle: 'ğŸ’¨ è¡æ“Šæ³¢',
            effectBlastWaveContent: 'å·¨å¤§çš„æ°£æµè¶…å£“ä»¥è¶…éŸ³é€Ÿå‘å¤–æ“´æ•£ï¼Œæ‘§æ¯€å»ºç¯‰ç‰©ã€æ©‹æ¨‘ç­‰æ‰€æœ‰åœ°é¢è¨­æ–½ã€‚ä¸€æš3è¬å™¸ç•¶é‡çš„åŸå­å½ˆï¼Œåœ¨800ç±³è™•çš„è¡æ“Šæ³¢é€Ÿåº¦ä»é«˜é”æ¯ç§’200ç±³ã€‚',
            effectEarlyRadiationTitle: 'â˜£ï¸ æ—©æœŸæ ¸è¼»å°„',
            effectEarlyRadiationContent: 'çˆ†ç‚¸æœ€åˆå¹¾åç§’é‡‹æ”¾çš„é«˜èƒ½ä¸­å­æµå’Œä¼½é¦¬å°„ç·šï¼Œèƒ½ç©¿é€äººé«”ï¼Œç ´å£DNAï¼Œå°è‡´æ€¥æ€§è¼»å°„ç—…ç”šè‡³æ­»äº¡ã€‚',
            effectEMPTitle: 'âš¡ é›»ç£è„ˆè¡ (EMP)',
            effectEMPContent: 'å¼·å¤§çš„é›»ç£è„ˆè¡èƒ½ç¬é–“æ‘§æ¯€å¤§ç¯„åœå…§çš„é›»å­è¨­å‚™ï¼Œå°è‡´é€šè¨Šä¸­æ–·ã€é›»ç¶²ç™±ç˜“ï¼Œä½¿ç¾ä»£ç¤¾æœƒé™·å…¥åœæ»¯ã€‚',
            effectFalloutTitle: 'ğŸŒ§ï¸ æ”¾å°„æ€§æ²¾æŸ“ (è¼»å°„å¡µ)',
            effectFalloutContent: 'çˆ†ç‚¸ç”¢ç”Ÿçš„æ”¾å°„æ€§å¾®ç²’éš¨è•ˆç‹€é›²é£„æ•£ï¼Œæœ€çµ‚è½å›åœ°é¢ï¼Œé€ æˆé•·æœŸç’°å¢ƒæ±¡æŸ“ï¼Œå°ç”Ÿç‰©æ§‹æˆæŒçºŒçš„å¥åº·å¨è„…ã€‚',

            // Conclusion Section
            conclusionTitle: 'çµ‚ç« ï¼šç§‘å­¸ã€åŠ›é‡èˆ‡è²¬ä»»',
            conclusionContent: 'åŸå­å½ˆæ˜¯äººé¡æ™ºæ…§çš„çµæ™¶ï¼Œä¹Ÿæ˜¯æ‡¸æ–¼æ–‡æ˜é ­é ‚çš„é”æ‘©å…‹åˆ©æ–¯ä¹‹åŠã€‚å®ƒå®Œç¾æ¼”ç¹¹äº†æ ¸åˆ†è£‚é€£é–åæ‡‰èˆ‡è³ªèƒ½è½‰æ›çš„ç‰©ç†åŸç†ï¼Œä½†å…¶å¤šé‡æ¯€æ»…æ•ˆæ‡‰ä¹Ÿå±•ç¤ºäº†ç§‘å­¸åŠ›é‡å¤±æ§æ™‚çš„ææ€–å¾Œæœã€‚ç†è§£å…¶åŸç†ï¼Œä¸åƒ…æ˜¯ç‚ºäº†çŸ¥è­˜ï¼Œæ›´æ˜¯ç‚ºäº†é«”æœƒé€™ä»½åŠ›é‡èƒŒå¾Œçš„æ²‰é‡è²¬ä»»ï¼Œä¸¦åæ€äººé¡æ‡‰å¦‚ä½•å’Œå¹³åœ°å…±å­˜ï¼Œè² è²¬ä»»åœ°é‹ç”¨æ”¹è®Šä¸–ç•Œçš„åŠ›é‡ã€‚'
        },
        'ja': {
            // Document Title
            documentTitle: 'åŸå­çˆ†å¼¾ã®åŸç†ï¼šã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ·±å±¤åˆ†æ',

            // Navigation
            navTitle: 'ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³',
            navIntro: 'åºç« ï¼šæ ¸å¿ƒã®ç§˜å¯†',
            navPrinciple: 'ç¬¬ä¸€ç« ï¼šæ ¸åˆ†è£‚ã®åŸç†',
            navChainReaction: 'ç¬¬äºŒç« ï¼šé€£é–åå¿œ',
            navDesign: 'ç¬¬ä¸‰ç« ï¼šå·¥å­¦çš„è¨­è¨ˆ',
            navPower: 'ç¬¬å››ç« ï¼šå¨åŠ›æº',
            navEffects: 'ç¬¬äº”ç« ï¼šç ´å£Šçš„åŠ¹æœ',
            navConclusion: 'çµ‚ç« ï¼šç§‘å­¦ã¨è²¬ä»»',

            // Intro Section
            introTitle: 'åŸå­çˆ†å¼¾',
            introSubtitle: 'ä¸–ç•Œã‚’å¤‰ãˆãŸç§‘å­¦é©å‘½ã€ç‰©è³ªã®å¥¥æ·±ãã«æ½œã‚€å·¨å¤§ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è§£ãæ”¾ã¤',
            introSectionTitle: 'æ ¸å¿ƒã®ç§˜å¯†',
            introContent: 'åŸå­çˆ†å¼¾ã¯ã€æ ¸åˆ†è£‚é€£é–åå¿œã‚’åˆ©ç”¨ã—ã¦ç¬æ™‚ã«è«å¤§ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ”¾å‡ºã™ã‚‹å…µå™¨ã§ã‚ã‚Šã€ãã®èª•ç”Ÿã¯20ä¸–ç´€ã®ç§‘å­¦æŠ€è¡“ã®é ‚ç‚¹ã§ã‚ã‚‹ã ã‘ã§ãªãã€æˆ¦äº‰ã®å½¢æ…‹ã¨å›½éš›æƒ…å‹¢ã‚’å®Œå…¨ã«å¤‰ãˆã¾ã—ãŸã€‚ã“ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¬ãƒãƒ¼ãƒˆã§ã¯ã€ãƒŸã‚¯ãƒ­ãªåŸå­æ ¸ã‹ã‚‰ãƒã‚¯ãƒ­ãªç ´å£ŠåŠ›ã¾ã§ã€åŸå­çˆ†å¼¾ã®ç§‘å­¦çš„åŸç†ã€å·¥å­¦çš„èª²é¡Œã€ãã—ã¦ãã®é©šç•°çš„ãªå¨åŠ›ã®æ ¹æºã‚’åŒ…æ‹¬çš„ã«åˆ†æã—ã¾ã™ã€‚',

            // Principle Section
            principleTitle: 'ç¬¬ä¸€ç« ï¼šæ ¸åˆ†è£‚ã®åŸç†',
            principleDescription: 'ã™ã¹ã¦ã¯åŸå­æ ¸ã®åˆ†è£‚ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚åŸå­çˆ†å¼¾ã®åŸºç¤ã¨ãªã‚‹ã®ã¯ã€Œæ ¸åˆ†è£‚ã€ã¨å‘¼ã°ã‚Œã‚‹ç‰©ç†ç¾è±¡ã§ã™ã€‚ä¸­æ€§å­ãŒé‡ã„åŸå­æ ¸ï¼ˆã‚¦ãƒ©ãƒ³235ãªã©ï¼‰ã«è¡çªã™ã‚‹ã¨ã€ãã®åŸå­æ ¸ã¯2ã¤ã®è»½ã„åŸå­ã«åˆ†è£‚ã—ã€åŒæ™‚ã«ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ã•ã‚‰ãªã‚‹ä¸­æ€§å­ã‚’æ”¾å‡ºã—ã€é€£é–åå¿œã®å¯èƒ½æ€§ã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚',
            principleKeyRawMaterialTitle: 'ä¸»è¦åŸæ–™ï¼šã‚¦ãƒ©ãƒ³235 vs ã‚¦ãƒ©ãƒ³238',
            principleKeyRawMaterialDescription: 'ã™ã¹ã¦ã®ã‚¦ãƒ©ãƒ³ãŒå®¹æ˜“ã«åˆ†è£‚ã™ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è‡ªç„¶ç•Œã®ã‚¦ãƒ©ãƒ³é‰±çŸ³ã®å¤§éƒ¨åˆ†ã¯å®‰å®šã—ãŸã‚¦ãƒ©ãƒ³238ã§ã‚ã‚Šã€åˆ†è£‚ã—ã‚„ã™ã„ã‚¦ãƒ©ãƒ³235ã¯ã‚ãšã‹ç´„0.7%ã§ã™ã€‚åŸå­çˆ†å¼¾ã‚’è£½é€ ã™ã‚‹ã«ã¯ã€ã‚¦ãƒ©ãƒ³235ã®æ¿ƒåº¦ã‚’90%ä»¥ä¸Šã«é«˜ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã“ã‚Œã¯éå¸¸ã«å›°é›£ã§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ¶ˆè²»ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã§ã™ã€‚',
            uraniumChartTitle: 'å¤©ç„¶ã‚¦ãƒ©ãƒ³ vs å…µå™¨ç´šã‚¦ãƒ©ãƒ³',
            uraniumChartLabelNaturalU238: 'ã‚¦ãƒ©ãƒ³238ï¼ˆå¤©ç„¶å­˜åœ¨æ¯”ï¼‰',
            uraniumChartLabelNaturalU235: 'ã‚¦ãƒ©ãƒ³235ï¼ˆå¤©ç„¶å­˜åœ¨æ¯”ï¼‰',
            uraniumChartLabelWeaponGrade: 'å…µå™¨ç´šã‚¦ãƒ©ãƒ³235ã«è¦æ±‚ã•ã‚Œã‚‹æ¿ƒåº¦',
            uraniumTooltipLabel: (context) => {
                let label = context.dataset.label || '';
                 if (label) { label += ': '; }
                 if (context.parsed !== null) { label += context.parsed + '%'; }
                 return label;
            },

            // Chain Reaction Section
            chainReactionTitle: 'ç¬¬äºŒç« ï¼šåˆ¶å¾¡ä¸èƒ½ãªé€£é–åå¿œ',
            chainReactionDescription: 'åŸå­çˆ†å¼¾ã®å¨åŠ›ã®ç§˜è¨£ã¯ã€Œåˆ¶å¾¡ä¸èƒ½ã€ã«ã‚ã‚Šã¾ã™ã€‚ä¸€åº¦ã®æ ¸åˆ†è£‚ã§2ã€œ3å€‹ã®ä¸­æ€§å­ãŒæ”¾å‡ºã•ã‚Œã€ãã‚Œãã‚Œã®ä¸­æ€§å­ãŒæ–°ãŸãªåˆ†è£‚ã‚’å¼•ãèµ·ã“ã—ã€æŒ‡æ•°é–¢æ•°çš„ã«ã‚¨ãƒãƒ«ã‚®ãƒ¼æ”¾å‡ºãŒå¢—å¤§ã—ã¾ã™ã€‚ã‚ãšã‹1ãƒã‚¤ã‚¯ãƒ­ç§’ã®é–“ã«ã€åˆ†è£‚ã™ã‚‹åŸå­ã®æ•°ã¯æ•°ç™¾å€ã«ã‚‚ãªã‚Šã€å¤©æ–‡å­¦çš„ãªé‡ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒç”Ÿã¿å‡ºã•ã‚Œã¾ã™ã€‚',
            chainReactionSimulationTitle: 'ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šé€£é–åå¿œã‚’é–‹å§‹',
            startReactionBtn: 'åå¿œã‚’é–‹å§‹',
            fissionCountText: 'åˆ†è£‚ã—ãŸåŸå­æ ¸ã®æ•°:',

            // Design Section
            designTitle: 'ç¬¬ä¸‰ç« ï¼šäºŒç¨®é¡ã®å·¥å­¦çš„è¨­è¨ˆ',
            designDescription: 'é€£é–åå¿œã‚’å¼•ãèµ·ã“ã™ãŸã‚ã«ã¯ã€ç¬æ™‚ã«ååˆ†ãªé‡ã®æ ¸ç‰©è³ªï¼ˆã€Œè‡¨ç•Œè³ªé‡ã€ã«é”ã™ã‚‹é‡ï¼‰ã‚’ä¸€ã¤ã«é›†ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ­´å²ä¸Šã€ä¸»ã«äºŒã¤ã®æ–¹æ³•ãŒç”¨ã„ã‚‰ã‚Œã¾ã—ãŸï¼šã‚¬ãƒ³ãƒãƒ¬ãƒ«å‹ã¨ã‚¤ãƒ³ãƒ—ãƒ­ãƒ¼ã‚¸ãƒ§ãƒ³å‹ã§ã™ã€‚ã“ã‚Œã‚‰äºŒã¤ã®è¨­è¨ˆã¯ã€ç‰©ç†ç†è«–ã‚’å·¥å­¦çš„ç¾å®Ÿã¸ã¨å¤‰æ›ã™ã‚‹ä¸Šã§ã®å·¨å¤§ãªèª²é¡Œã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚',
            gunBtn: 'ã‚¬ãƒ³ãƒãƒ¬ãƒ«å‹',
            implosionBtn: 'ã‚¤ãƒ³ãƒ—ãƒ­ãƒ¼ã‚¸ãƒ§ãƒ³å‹',
            designGun: {
                title: 'ã‚¬ãƒ³ãƒãƒ¬ãƒ«å‹',
                description: 'æ§‹é€ ã¯æ¯”è¼ƒçš„å˜ç´”ã§ã€ç ²èº«ã«ä¼¼ã¦ã„ã¾ã™ã€‚äºŒã¤ã®äºœè‡¨ç•Œè³ªé‡ã‚¦ãƒ©ãƒ³235ã‚’åˆ¥ã€…ã«é…ç½®ã—ã€èµ·çˆ†æ™‚ã«é€šå¸¸çˆ†è–¬ã§ç‰‡æ–¹ã‚’ã‚‚ã†ä¸€æ–¹ã«ã€Œæ’ƒã¡è¾¼ã¿ã€ã€ç¬æ™‚ã«è¶…è‡¨ç•Œè³ªé‡ã‚’å½¢æˆã—ã¦çˆ†ç™ºã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚',
                example: 'ä¾‹ï¼šåºƒå³¶ã«æŠ•ä¸‹ã•ã‚ŒãŸã€Œãƒªãƒˆãƒ«ãƒœãƒ¼ã‚¤ã€ã€‚',
                pros: 'åˆ©ç‚¹ï¼šæ§‹é€ ãŒå˜ç´”ã§ä¿¡é ¼æ€§ãŒé«˜ã„ã€‚',
                cons: 'æ¬ ç‚¹ï¼šåŠ¹ç‡ãŒä½ã„ï¼ˆç‡ƒæ–™åˆ©ç”¨ç‡ã¯ã‚ãšã‹ç´„2%ï¼‰ã€å®‰å…¨æ€§ãŒä½ãã€ã‚¦ãƒ©ãƒ³ã—ã‹ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚',
                triggerBtn: 'ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒˆãƒªã‚¬ãƒ¼'
            },
            designImplosion: {
                title: 'ã‚¤ãƒ³ãƒ—ãƒ­ãƒ¼ã‚¸ãƒ§ãƒ³å‹',
                description: 'æ§‹é€ ã¯ã‚ˆã‚Šè¤‡é›‘ã§ã™ã€‚äºœè‡¨ç•Œè³ªé‡ã®æ ¸ç‰©è³ªï¼ˆãƒ—ãƒ«ãƒˆãƒ‹ã‚¦ãƒ ã¾ãŸã¯ã‚¦ãƒ©ãƒ³ï¼‰ã‚’ä¸­å¤®ã«é…ç½®ã—ã€ãã®å¤–å´ã‚’çƒçŠ¶ã«é…ç½®ã•ã‚ŒãŸé€šå¸¸çˆ†è–¬ã§å›²ã¿ã¾ã™ã€‚èµ·çˆ†æ™‚ã«ã¯ã€çˆ†è–¬ãŒåŒæ™‚ã«å†…å´ã¸çˆ†ç™ºã—ã€å·¨å¤§ãªåœ§åŠ›ã‚’ç”Ÿã¿å‡ºã—ã¦æ ¸ã‚’ç¬æ™‚ã«è¶…è‡¨ç•Œå¯†åº¦ã¾ã§åœ§ç¸®ã—ã¾ã™ã€‚',
                example: 'ä¾‹ï¼šé•·å´ã«æŠ•ä¸‹ã•ã‚ŒãŸã€Œãƒ•ã‚¡ãƒƒãƒˆãƒãƒ³ã€ã€‚',
                pros: 'åˆ©ç‚¹ï¼šã¯ã‚‹ã‹ã«é«˜åŠ¹ç‡ï¼ˆç‡ƒæ–™åˆ©ç”¨ç‡ã¯ç´„17%ï¼‰ã€ã‚ˆã‚Šåå¿œæ€§ã®é«˜ã„ãƒ—ãƒ«ãƒˆãƒ‹ã‚¦ãƒ ã‚’ä½¿ç”¨å¯èƒ½ã€‚',
                cons: 'æ¬ ç‚¹ï¼šæ§‹é€ ãŒè¤‡é›‘ã§ã€çˆ†è–¬ã®åŒæ™‚èµ·çˆ†ã«å¯¾ã™ã‚‹è¦æ±‚ãŒæ¥µã‚ã¦é«˜ã„ã€‚',
                triggerBtn: 'ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒˆãƒªã‚¬ãƒ¼'
            },

            // Power Section
            powerTitle: 'ç¬¬å››ç« ï¼šå¨åŠ›æº E=mcÂ²',
            powerDescription: 'åŸå­çˆ†å¼¾ã®é©šãã¹ãå¨åŠ›ã¯ã€æœ€çµ‚çš„ã«ã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³ã®è³ªé‡ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç­‰ä¾¡æ€§ã‚’ç¤ºã™å…¬å¼ E=mcÂ² ã«å¸°ç€ã—ã¾ã™ã€‚æ ¸åˆ†è£‚ã§ã¯ã€ç”Ÿæˆç‰©ã®ç·è³ªé‡ãŒåå¿œå‰ã‚ˆã‚Šã‚ãšã‹ã«æ¸›å°‘ã—ã¾ã™ã€‚ã“ã®ã€Œæ¶ˆå¤±ã—ãŸã€å¾®å°ãªè³ªé‡ãŒã€å…‰é€Ÿã®äºŒä¹—ã‚’ä¹—ã˜ã‚‹ã“ã¨ã§å·¨å¤§ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚ã“ã‚ŒãŒã€æ ¸åå¿œã¨åŒ–å­¦åå¿œã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ¬ãƒ™ãƒ«ã«ãŠã‘ã‚‹æ ¹æœ¬çš„ãªé•ã„ã§ã™ã€‚',
            energyComparisonTitle: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¯”è¼ƒï¼šæ ¸åå¿œ vs åŒ–å­¦åå¿œ',
            energyComparisonDescription: '1ã‚­ãƒ­ã‚°ãƒ©ãƒ ã®ã‚¦ãƒ©ãƒ³ãŒå®Œå…¨ã«åˆ†è£‚ã—ã¦æ”¾å‡ºã•ã‚Œã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€ç´„2ä¸‡ãƒˆãƒ³ã®TNTçˆ†è–¬ã«ç›¸å½“ã—ã¾ã™ã€‚ä¸‹ã®å›³ã¯ã€ã“ã®æƒ³åƒã‚’çµ¶ã™ã‚‹å·®ã‚’è¦–è¦šçš„ã«ç¤ºã—ã¦ã„ã¾ã™ã€‚',
            energyChartLabel: 'æ”¾å‡ºã‚¨ãƒãƒ«ã‚®ãƒ¼ (TNTæ›ç®—ãƒˆãƒ³)',
            energyChartXAxisTitle: 'TNTå½“é‡ (ãƒˆãƒ³) - å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«',
            energyChartLabelsKgTNT: '1ã‚­ãƒ­ã‚°ãƒ©ãƒ  TNT',
            energyChartLabelsKgU235: '1ã‚­ãƒ­ã‚°ãƒ©ãƒ  ã‚¦ãƒ©ãƒ³235',
            energyTooltipLabel: (context) => {
                return `${context.dataset.label}: ${context.raw.toLocaleString()} ãƒˆãƒ³ TNTå½“é‡`;
            },

            // Effects Section
            effectsTitle: 'ç¬¬äº”ç« ï¼šå¤šé‡ç ´å£ŠåŠ¹æœ',
            effectsDescription: 'åŸå­çˆ†å¼¾ã®ç ´å£ŠåŠ›ã¯å¤šå±¤çš„ã‹ã¤è¤‡åˆçš„ã§ã™ã€‚çˆ†ç™ºã®ç¬é–“ã«æ”¾å‡ºã•ã‚Œã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€æ§˜ã€…ãªå½¢ã§ç›®æ¨™åœ°åŸŸã«å£Šæ»…çš„ãªæ‰“æ’ƒã‚’ä¸ãˆã€ãã®å½±éŸ¿ã¯å³åº§ã®ç‰©ç†çš„ç ´å£Šã‹ã‚‰é•·æœŸçš„ãªç’°å¢ƒãŠã‚ˆã³ç”Ÿç‰©å­¦çš„å±å®³ã«ã¾ã§åŠã³ã¾ã™ã€‚',
            effectLightRadiationTitle: 'ğŸ”¥ å…‰æ”¾å°„ (ç†±æ”¾å°„)',
            effectLightRadiationContent: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç´„35%ãŒç†±æ”¾å°„ã¨ã—ã¦æ”¾å‡ºã•ã‚Œã€å…‰é€Ÿã§ä¼æ’­ã—ã¾ã™ã€‚ä¸­å¿ƒéƒ¨ã®æ¸©åº¦ã¯æ•°åä¸‡åº¦ã«é”ã—ã€åºƒç¯„å›²ã«ã‚ãŸã‚‹ç«å‚·ã‚’å¼•ãèµ·ã“ã—ã€ã‚ã‚‰ã‚†ã‚‹å¯ç‡ƒç‰©ã‚’ç‡ƒã‚„ã—ã¾ã™ã€‚',
            effectBlastWaveTitle: 'ğŸ’¨ è¡æ’ƒæ³¢',
            effectBlastWaveContent: 'å·¨å¤§ãªæ°—æµã®éåœ§ãŒè¶…éŸ³é€Ÿã§å¤–å´ã«æ‹¡æ•£ã—ã€å»ºç‰©ã€æ©‹æ¢ãªã©ã™ã¹ã¦ã®åœ°ä¸Šæ–½è¨­ã‚’ç ´å£Šã—ã¾ã™ã€‚3ä¸‡ãƒˆãƒ³ç´šã®åŸå­çˆ†å¼¾ã®å ´åˆã€800ãƒ¡ãƒ¼ãƒˆãƒ«åœ°ç‚¹ã§ã‚‚è¡æ’ƒæ³¢ã®é€Ÿåº¦ã¯æ¯ç§’200ãƒ¡ãƒ¼ãƒˆãƒ«ã«é”ã—ã¾ã™ã€‚',
            effectEarlyRadiationTitle: 'â˜£ï¸ åˆæœŸæ ¸æ”¾å°„ç·š',
            effectEarlyRadiationContent: 'çˆ†ç™ºã®æœ€åˆã®æ•°åç§’ã§æ”¾å‡ºã•ã‚Œã‚‹é«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ä¸­æ€§å­æµã¨ã‚¬ãƒ³ãƒç·šã¯ã€äººä½“ã‚’é€éã—ã€DNAã‚’æå‚·ã•ã›ã€æ€¥æ€§æ”¾å°„ç·šç—…ã‚„æ­»ã«è‡³ã‚‰ã›ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚',
            effectEMPTitle: 'âš¡ é›»ç£ãƒ‘ãƒ«ã‚¹ (EMP)',
            effectEMPContent: 'å¼·åŠ›ãªé›»ç£ãƒ‘ãƒ«ã‚¹ã¯ã€åºƒç¯„å›²ã®é›»å­æ©Ÿå™¨ã‚’ç¬æ™‚ã«ç ´å£Šã—ã€é€šä¿¡é€”çµ¶ã€é›»åŠ›ç¶²ã®éº»ç—ºã‚’å¼•ãèµ·ã“ã—ã€ç¾ä»£ç¤¾ä¼šã‚’åœæ­¢ã•ã›ã¾ã™ã€‚',
            effectFalloutTitle: 'ğŸŒ§ï¸ æ”¾å°„æ€§é™ä¸‹ç‰© (æ”¾å°„æ€§å¡µ)',
            effectFalloutContent: 'çˆ†ç™ºã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸæ”¾å°„æ€§å¾®ç²’å­ã¯ã€ã‚­ãƒã‚³é›²ã¨ã¨ã‚‚ã«æ‹¡æ•£ã—ã€æœ€çµ‚çš„ã«åœ°ä¸Šã«è½ä¸‹ã—ã¦é•·æœŸçš„ãªç’°å¢ƒæ±šæŸ“ã‚’å¼•ãèµ·ã“ã—ã€ç”Ÿç‰©ã«å¯¾ã—ã¦æŒç¶šçš„ãªå¥åº·è¢«å®³ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚',

            // Conclusion Section
            conclusionTitle: 'çµ‚ç« ï¼šç§‘å­¦ã€åŠ›ã€ãã—ã¦è²¬ä»»',
            conclusionContent: 'åŸå­çˆ†å¼¾ã¯äººé¡ã®çŸ¥æ€§ã®çµæ™¶ã§ã‚ã‚Šã€æ–‡æ˜ã®é ­ä¸Šã«åŠã‚‹ã•ã‚ŒãŸãƒ€ãƒ¢ã‚¯ãƒ¬ã‚¹ã®å‰£ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚ãã‚Œã¯æ ¸åˆ†è£‚é€£é–åå¿œã¨è³ªé‡ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰æ›ã®ç‰©ç†åŸç†ã‚’å®Œç’§ã«å…·ç¾åŒ–ã—ã¦ã„ã¾ã™ãŒã€ãã®å¤šé‡ç ´å£ŠåŠ¹æœã¯ã€ç§‘å­¦ã®åŠ›ãŒåˆ¶å¾¡ã‚’å¤±ã£ãŸæ™‚ã®æã‚ã—ã„çµæœã‚‚ç¤ºã—ã¦ã„ã¾ã™ã€‚ãã®åŸç†ã‚’ç†è§£ã™ã‚‹ã“ã¨ã¯ã€çŸ¥è­˜ã®ãŸã‚ã ã‘ã§ãªãã€ã“ã®åŠ›ã®èƒŒå¾Œã«ã‚ã‚‹é‡ã„è²¬ä»»ã‚’æ„Ÿã˜ã€äººé¡ãŒã„ã‹ã«å¹³å’Œçš„ã«å…±å­˜ã—ã€ä¸–ç•Œã‚’å¤‰ãˆã‚‹åŠ›ã‚’è²¬ä»»ã‚’æŒã£ã¦ç”¨ã„ã‚‹ã¹ãã‹ã‚’æ·±ãè€ƒãˆã‚‹ãŸã‚ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚'
        }
    };

    // Helper to get translated text
    function getTranslatedText(key, lang) {
        return translations[lang][key];
    }

    // Function to update all text elements
    function updateTextContent(lang) {
        // Update document title
        document.title = getTranslatedText('documentTitle', lang);
        document.documentElement.lang = lang; // Update html lang attribute

        // Update elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[lang][key]) {
                // Special handling for fission count text to preserve the span
                if (key === 'fissionCountText') {
                    const countSpan = element.querySelector('#fission-count');
                    element.innerHTML = getTranslatedText(key, lang) + ` <span id="fission-count" class="font-bold text-xl text-[#B85C5C]">${fissionCount}</span>`;
                } else {
                    element.textContent = getTranslatedText(key, lang);
                }
            }
        });

        // Update Chart.js charts
        updateUraniumPurityChart(lang);
        updateEnergyComparisonChart(lang);

        // Update Bomb Design section
        updateDesignView(document.getElementById('gun-btn').classList.contains('active') ? 'gun' : 'implosion', lang);
    }

    // --- Side Navigation Logic ---
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('section');

    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.4
    };

    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === entry.target.id) {
                        link.classList.add('active');
                    }
                });
            }
        });
    }, observerOptions);

    sections.forEach(section => {
        observer.observe(section);
    });
    
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            document.querySelector(link.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });

    // --- Chart: Uranium Purity ---
    function updateUraniumPurityChart(lang) {
        if (currentChartUranium) {
            currentChartUranium.destroy();
        }
        const uraniumPurityCtx = document.getElementById('uraniumPurityChart').getContext('2d');
        currentChartUranium = new Chart(uraniumPurityCtx, {
            type: 'doughnut',
            data: {
                labels: [
                    getTranslatedText('uraniumChartLabelNaturalU238', lang),
                    getTranslatedText('uraniumChartLabelNaturalU235', lang),
                    getTranslatedText('uraniumChartLabelWeaponGrade', lang)
                ],
                datasets: [{
                    label: getTranslatedText('uraniumChartLabelNaturalU238', lang), // A bit of a hack to make label appear for dataset 0
                    data: [99.3, 0.7, 0], // Placeholder for visual separation
                    backgroundColor: ['#a9a9a9', '#5C85B8', 'rgba(0,0,0,0)'],
                    borderColor: '#F8F7F4',
                    borderWidth: 2
                }, {
                    label: getTranslatedText('uraniumChartLabelWeaponGrade', lang),
                    data: [10, 90],
                    backgroundColor: ['#dcdcdc', '#B85C5C'],
                    borderColor: '#F8F7F4',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: { display: true, text: getTranslatedText('uraniumChartTitle', lang), font: { size: 16 } },
                    tooltip: {
                        callbacks: {
                            label: translations[lang].uraniumTooltipLabel
                        }
                    }
                }
            }
        });
    }

    // --- Animation: Chain Reaction ---
    const canvas = document.getElementById('chainReactionCanvas');
    const ctx = canvas.getContext('2d');
    const startBtn = document.getElementById('startReactionBtn');
    const fissionCountEl = document.getElementById('fission-count');
    let animationFrameId;
    let particles = [];
    let neutrons = [];
    let fissionCount = 0;

    function resizeCanvas() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
    }
    
    class Particle {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.radius = 5;
            this.color = '#5C85B8';
            this.isFissioned = false;
        }
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.fill();
        }
        fission() {
            if (!this.isFissioned) {
                this.isFissioned = true;
                this.color = '#B85C5C';
                fissionCount++;
                fissionCountEl.textContent = fissionCount;
                for (let i = 0; i < 2; i++) {
                    neutrons.push(new Neutron(this.x, this.y));
                }
            }
        }
    }

    class Neutron {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.radius = 2;
            this.color = '#333333';
            this.vx = (Math.random() - 0.5) * 4;
            this.vy = (Math.random() - 0.5) * 4;
        }
        update() {
            this.x += this.vx;
            this.y += this.vy;
            particles.forEach(p => {
                const dist = Math.hypot(this.x - p.x, this.y - p.y);
                if (dist < p.radius + this.radius && !p.isFissioned) {
                    p.fission();
                    this.vx = 0; this.vy = 0; // stop this neutron
                }
            });
        }
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.fill();
        }
    }

    function initAnimation() {
        cancelAnimationFrame(animationFrameId);
        resizeCanvas();
        particles = [];
        neutrons = [];
        fissionCount = 0;
        fissionCountEl.textContent = 0;
        const particleCount = Math.floor(canvas.width * canvas.height / 4000);
        for (let i = 0; i < particleCount; i++) {
            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height;
            particles.push(new Particle(x, y));
        }
        drawAll();
    }

    function drawAll() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => p.draw());
        neutrons.forEach(n => n.draw());
    }

    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => p.draw());
        neutrons.forEach(n => {
            n.update();
            n.draw();
        });
        neutrons = neutrons.filter(n => n.x > 0 && n.x < canvas.width && n.y > 0 && n.y < canvas.height && (n.vx !== 0 || n.vy !== 0));
        if (neutrons.length > 0) {
            animationFrameId = requestAnimationFrame(animate);
        }
    }

    startBtn.addEventListener('click', () => {
        initAnimation();
        // Start with one neutron
        neutrons.push(new Neutron(10, canvas.height / 2));
        animate();
    });

    window.addEventListener('resize', initAnimation);
    initAnimation();

    // --- Bomb Design Toggler ---
    const gunBtn = document.getElementById('gun-btn');
    const implosionBtn = document.getElementById('implosion-btn');
    const display = document.getElementById('design-display');

    function updateDesignView(type, lang) {
        const content = translations[lang][`design${type.charAt(0).toUpperCase() + type.slice(1)}`]; // e.g., translations[lang].designGun
        display.innerHTML = `
            <h4 class="text-xl font-bold text-center mb-2">${content.title}</h4>
            <p class="text-gray-600 mb-4 text-center">${content.description}</p>
            <div class="w-full h-48 bg-gray-100 rounded-lg flex items-center justify-center p-4 relative overflow-hidden">
                ${type === 'gun' ? `
                    <div class="w-full h-8 bg-gray-400 rounded-full relative flex items-center">
                       <div id="gun-target" class="gun-piece w-12 h-12 bg-[#5C85B8] rounded-full absolute right-8"></div>
                       <div id="gun-bullet" class="gun-piece w-12 h-12 bg-[#5C85B8] rounded-full absolute left-8"></div>
                    </div>
                ` : `
                    <div id="implosion-core" class="implosion-segment w-12 h-12 bg-[#B85C5C] rounded-full absolute z-10"></div>
                    <div id="implosion-lense-1" class="implosion-segment w-24 h-12 bg-gray-400 absolute" style="clip-path: polygon(0 0, 100% 0, 80% 100%, 20% 100%); top: 1rem;"></div>
                    <div id="implosion-lense-2" class="implosion-segment w-24 h-12 bg-gray-400 absolute" style="clip-path: polygon(20% 0, 80% 0, 100% 100%, 0% 100%); bottom: 1rem;"></div>
                    <div id="implosion-lense-3" class="implosion-segment w-12 h-24 bg-gray-400 absolute" style="clip-path: polygon(0 0, 100% 20%, 100% 80%, 0 100%); left: 1rem;"></div>
                    <div id="implosion-lense-4" class="implosion-segment w-12 h-24 bg-gray-400 absolute" style="clip-path: polygon(100% 0, 0 20%, 0 80%, 100% 100%); right: 1rem;"></div>
                `}
            </div>
            <div class="text-center mt-4">
                <button id="${type === 'gun' ? 'trigger-gun' : 'trigger-implosion'}" class="btn-primary py-1 px-4 rounded-md text-sm">${content.triggerBtn}</button>
            </div>
            <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                <div class="bg-blue-50 p-3 rounded-lg"><strong>${translations[lang].exampleLabel || 'å¯¦ä¾‹:'}</strong> ${content.example}</div>
                <div class="bg-green-50 p-3 rounded-lg"><strong>${translations[lang].prosLabel || 'å„ªé»:'}</strong> ${content.pros}</div>
                <div class="bg-red-50 p-3 rounded-lg"><strong>${translations[lang].consLabel || 'ç¼ºé»:'}</strong> ${content.cons}</div>
            </div>
        `;

        if (type === 'gun') {
            document.getElementById('trigger-gun').addEventListener('click', () => {
                const bullet = document.getElementById('gun-bullet');
                bullet.style.transform = `translateX(${bullet.parentElement.offsetWidth / 2 - bullet.offsetWidth}px)`;
                setTimeout(() => { bullet.style.transform = 'translateX(0)'; }, 1500);
            });
        } else {
            document.getElementById('trigger-implosion').addEventListener('click', () => {
                const core = document.getElementById('implosion-core');
                const lenses = document.querySelectorAll('[id^="implosion-lense"]');
                core.style.transform = 'scale(0.5)';
                lenses.forEach(l => l.style.transform = 'scale(1.2)');
                setTimeout(() => {
                    core.style.transform = 'scale(1)';
                    lenses.forEach(l => l.style.transform = 'scale(1)');
                }, 800);
            });
        }
    }

    gunBtn.addEventListener('click', () => {
        gunBtn.classList.add('active');
        implosionBtn.classList.remove('active');
        updateDesignView('gun', languageSwitcher.value);
    });

    implosionBtn.addEventListener('click', () => {
        implosionBtn.classList.add('active');
        gunBtn.classList.remove('active');
        updateDesignView('implosion', languageSwitcher.value);
    });
    
    // --- Chart: Energy Comparison ---
    function updateEnergyComparisonChart(lang) {
        if (currentChartEnergy) {
            currentChartEnergy.destroy();
        }
        const energyCtx = document.getElementById('energyComparisonChart').getContext('2d');
        currentChartEnergy = new Chart(energyCtx, {
            type: 'bar',
            data: {
                labels: [
                    getTranslatedText('energyChartLabelsKgTNT', lang),
                    getTranslatedText('energyChartLabelsKgU235', lang)
                ],
                datasets: [{
                    label: getTranslatedText('energyChartLabel', lang),
                    data: [0.001, 20000],
                    backgroundColor: ['#5C85B8', '#B85C5C'],
                    borderColor: ['#4a6a93', '#934a4a'],
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        type: 'logarithmic',
                        title: { display: true, text: getTranslatedText('energyChartXAxisTitle', lang) }
                    }
                },
                plugins: {
                    title: { display: true, text: getTranslatedText('energyComparisonTitle', lang), font: { size: 16 } },
                    tooltip: {
                        callbacks: {
                            label: translations[lang].energyTooltipLabel
                        }
                    }
                }
            }
        });
    }

    // --- Accordion for Effects ---
    const effectItems = document.querySelectorAll('.effect-item');
    effectItems.forEach(item => {
        const button = item.querySelector('.effect-button');
        const content = item.querySelector('.effect-content');
        const arrow = item.querySelector('.arrow');
        button.addEventListener('click', () => {
            const isHidden = content.classList.contains('hidden');
            // Close all others
            effectItems.forEach(otherItem => {
                otherItem.querySelector('.effect-content').classList.add('hidden');
                otherItem.querySelector('.arrow').classList.remove('rotate-180');
            });
            // Toggle current
            if (isHidden) {
                content.classList.remove('hidden');
                arrow.classList.add('rotate-180');
            }
        });
    });

    // Initialize with preferred language from localStorage or default to Traditional Chinese
    const savedLanguage = localStorage.getItem('appLanguage') || 'zh-Hant';
    languageSwitcher.value = savedLanguage;
    updateTextContent(savedLanguage);
    updateDesignView('gun', savedLanguage); // Ensure initial design view is also translated

    // Event listener for language switcher
    languageSwitcher.addEventListener('change', (event) => {
        const newLang = event.target.value;
        localStorage.setItem('appLanguage', newLang); // Save preference
        updateTextContent(newLang);
    });
});
</script>

</body>
</html>
