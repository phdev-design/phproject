<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Godot Y-Sort äº’å‹•å¼æ•™å­¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
        }
        .card {
            background-color: #2d3748;
            border-radius: 0.75rem;
            border: 1px solid #4a5568;
            overflow: hidden;
        }
        .card-header {
            background-color: #4a5568;
            padding: 1rem 1.5rem;
            font-weight: 700;
            font-size: 1.25rem;
        }
        .card-body {
            padding: 1.5rem;
        }
        .code {
            background-color: #1a202c;
            color: #90cdf4;
            padding: 0.2rem 0.5rem;
            border-radius: 0.25rem;
            font-family: monospace;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #48bb78;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        canvas {
            background-color: #4a5568;
            border-radius: 0.5rem;
            cursor: grab;
        }
        canvas:active {
            cursor: grabbing;
        }
        .lang-switcher {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: #4a5568;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .lang-switcher:hover {
            background-color: #718096;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto space-y-8 relative">
        <button id="langSwitcher" class="lang-switcher">English</button>
        <header class="text-center pt-8">
            <h1 class="text-4xl font-bold text-white" data-lang="title">æ·±å…¥ç†è§£ Godot çš„ Y-Sort</h1>
            <p class="text-lg text-gray-400 mt-2" data-lang="subtitle">ä¸€å€‹è§£æ±º 2D æ’åºå•é¡Œçš„äº’å‹•æŒ‡å—</p>
        </header>

        <!-- Interactive Demo -->
        <div class="card">
            <div class="card-header" data-lang="demoHeader">äº’å‹•ç¯„ä¾‹ï¼šçœ¼è¦‹ç‚ºæ†‘</div>
            <div class="card-body md:flex md:space-x-6 items-center">
                <div class="flex-grow">
                    <canvas id="demoCanvas" width="400" height="300"></canvas>
                    <p class="text-sm text-gray-400 mt-2 text-center" data-lang="demoHint">æç¤ºï¼šç”¨æ»‘é¼ æ‹–æ›³è§’è‰²ä¾†ç§»å‹•</p>
                </div>
                <div class="mt-4 md:mt-0 md:w-1/3 space-y-4">
                    <p data-lang="demoInstructions">è©¦è‘—æ‹–æ›³ã€Œè§’è‰²ã€ï¼Œè®“ä»–å¾ã€Œæ¨¹ã€çš„å‰æ–¹å’Œå¾Œæ–¹ç¶“éï¼Œè§€å¯Ÿä»–çš„åœ–å±¤è®ŠåŒ–ã€‚</p>
                    <div class="flex items-center justify-between bg-gray-700 p-3 rounded-lg">
                        <span class="font-bold text-lg" data-lang="demoToggleLabel">ä¿®æ­£æ’åºåŸé»</span>
                        <label class="switch">
                            <input type="checkbox" id="fixOriginToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div id="statusText" class="text-center font-bold text-xl p-2 rounded-lg"></div>
                </div>
            </div>
        </div>

        <!-- The Core Problem -->
        <div class="card">
            <div class="card-header" data-lang="problemHeader">æ ¸å¿ƒå•é¡Œï¼šä½ ä»¥ç‚ºçš„ã€Œä½ç½®ã€ä¸æ˜¯ Godot ä»¥ç‚ºçš„ä½ç½®</div>
            <div class="card-body space-y-4">
                <p data-lang="problemDesc1">ç•¶ä½ å•Ÿç”¨ <code class="code">Y Sort Enabled</code> æ™‚ï¼ŒGodot æœƒæ ¹æ“šå­ç¯€é»çš„ Y åº§æ¨™ä¾†æ±ºå®šç¹ªè£½é †åºï¼šY å€¼è¶Šå¤§ï¼ˆåœ¨ç•«é¢ä¸Šè¶Šä¸‹æ–¹ï¼‰çš„ç¯€é»ï¼Œæœƒè¢«ç•«åœ¨è¶Šä¸Šå±¤ã€‚</p>
                <p class="font-bold text-xl" data-lang="problemDesc2">ä½†é—œéµåœ¨æ–¼ï¼ŒGodot æ¯”è¼ƒçš„ä¸æ˜¯æ•´å€‹åœ–ç‰‡çš„ä½ç½®ï¼Œè€Œæ˜¯æ¯å€‹ç¯€é»çš„ã€ŒåŸé» (Origin)ã€çš„ Y åº§æ¨™ã€‚</p>
                <div class="grid md:grid-cols-2 gap-4 text-center">
                    <div class="bg-gray-800 p-4 rounded-lg">
                        <h3 class="font-bold text-lg text-red-400" data-lang="problemWrongTitle">âŒ éŒ¯èª¤çš„æ’åº (é è¨­æƒ…æ³)</h3>
                        <img src="https://placehold.co/300x200/2d3748/e2e8f0?text=Incorrect Sorting Diagram" alt="Incorrect Sorting Diagram" class="mx-auto my-2 rounded">
                        <p class="text-sm" data-lang="problemWrongDesc">è§’è‰²å’Œæ¨¹çš„åŸé»éƒ½åœ¨å·¦ä¸Šè§’ã€‚ç•¶è§’è‰²åœ¨æ¨¹çš„å‰æ–¹æ™‚ï¼Œä»–çš„åŸé» Y åº§æ¨™æ¯”æ¨¹çš„åŸé»å°ï¼Œæ‰€ä»¥è¢«ç•«åœ¨æ¨¹çš„å¾Œé¢ã€‚</p>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-lg">
                        <h3 class="font-bold text-lg text-green-400" data-lang="problemRightTitle">âœ… æ­£ç¢ºçš„æ’åº</h3>
                        <img src="https://placehold.co/300x200/2d3748/e2e8f0?text=Correct Sorting Diagram" alt="Correct Sorting Diagram" class="mx-auto my-2 rounded">
                        <p class="text-sm" data-lang="problemRightDesc">å°‡åŸé»ç§»åˆ°ç‰©ä»¶çš„ã€Œè…³ä¸‹ã€ã€‚ç¾åœ¨ç•¶è§’è‰²åœ¨æ¨¹çš„å‰æ–¹æ™‚ï¼Œä»–çš„åŸé» Y åº§æ¨™æ¯”æ¨¹å¤§ï¼Œå› æ­¤è¢«æ­£ç¢ºåœ°ç•«åœ¨æ¨¹çš„å‰é¢ã€‚</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Solutions -->
        <div class="space-y-8">
            <h2 class="text-3xl font-bold text-center text-white" data-lang="solutionsHeader">è§£æ±ºæ–¹æ¡ˆ</h2>
            
            <div class="card">
                <div class="card-header" data-lang="solution1Header">æ–¹æ³•ä¸€ï¼šé‡å°ç¨ç«‹ç¯€é» (å¦‚ Player, Tree)</div>
                <div class="card-body space-y-4">
                    <p data-lang="solution1Desc">å°æ–¼ç¨ç«‹çš„å ´æ™¯å¯¦ä¾‹ï¼ˆä¾‹å¦‚ç©å®¶ã€NPCã€å¯æ‹¾å–çš„é“å…·ã€å–®ç¨æ”¾ç½®çš„æ¨¹ï¼‰ï¼Œä½ éœ€è¦èª¿æ•´å®ƒå€‘ Sprite çš„åŸé»ã€‚</p>
                    <ol class="list-decimal list-inside space-y-2">
                        <li data-lang="solution1Step1">æ‰“é–‹ä½ çš„ç‰©ä»¶å ´æ™¯ (ä¾‹å¦‚ `Player.tscn` æˆ– `Tree.tscn`)ã€‚</li>
                        <li data-lang="solution1Step2">åœ¨å ´æ™¯æ¨¹ä¸­é¸æ“‡è² è²¬é¡¯ç¤ºåœ–å½¢çš„ <code class="code">Sprite2D</code> æˆ– <code class="code">AnimatedSprite2D</code> ç¯€é»ã€‚</li>
                        <li data-lang="solution1Step3">åœ¨å³é‚Šçš„ã€å±¬æ€§é¢æ¿ã€‘ä¸­ï¼Œæ‰¾åˆ° <code class="code">Transform</code> åˆ†é¡ä¸‹çš„ <code class="code">Offset</code> å±¬æ€§ã€‚</li>
                        <li data-lang="solution1Step4">èª¿æ•´ <code class="code">Offset</code> çš„ Y å€¼ï¼Œå°‡åœ–ç‰‡å‘ä¸Šç§»å‹•ï¼Œç›´åˆ°ç¯€é»çš„åŸé» (é‚£å€‹å°å°çš„åå­—) å°æº–ç‰©ä»¶çš„è…³ä¸‹ã€‚é€šå¸¸ Y å€¼æœƒæ˜¯ä¸€å€‹è² æ•¸ã€‚</li>
                    </ol>
                    <div class="bg-gray-800 p-4 rounded-lg">
                        <p class="font-bold" data-lang="solution1TipTitle">ğŸ’¡ æç¤ºï¼š</p>
                        <p data-lang="solution1TipDesc">åœ¨ 2D è¦–åœ–ä¸­ï¼Œé¸æ“‡ç§»å‹•å·¥å…· (W)ï¼Œç„¶å¾ŒæŒ‰ä½ <code class="code">Alt</code> éµæ‹–æ›³ä½ çš„ Spriteã€‚é€™æ¨£å¯ä»¥ç›´æ¥ä¿®æ”¹ Offsetï¼Œéå¸¸ç›´è§€ã€‚</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header" data-lang="solution2Header">æ–¹æ³•äºŒï¼šé‡å° TileMap</div>
                <div class="card-body space-y-4">
                    <p data-lang="solution2Desc">ç•¶ä½ çš„é®æ“‹ç‰©ï¼ˆä¾‹å¦‚æ¨¹ã€ç‰†å£ï¼‰æ˜¯ç•«åœ¨ <code class="code">TileMap</code> ä¸Šæ™‚ï¼Œè¨­å®šæœƒç¨å¾®ä¸åŒï¼Œéœ€è¦å…©æ­¥é—œéµæ“ä½œã€‚</p>
                    <h3 class="font-bold text-lg" data-lang="solution2Step1Title">ç¬¬ä¸€æ­¥ï¼šåœ¨ TileMap åœ–å±¤ä¸Šå•Ÿç”¨ Y-Sort</h3>
                    <p data-lang="solution2Step1Desc">ä½ éœ€è¦å‘Šè¨´ Godotï¼Œé€™å€‹åœ–å±¤ä¸Šçš„ç“¦ç‰‡éœ€è¦å½¼æ­¤ä¹‹é–“é€²è¡Œ Y è»¸æ’åºã€‚</p>
                     <ol class="list-decimal list-inside space-y-2">
                        <li data-lang="solution2_1_Step1">åœ¨ä½ çš„ä¸»å ´æ™¯ä¸­ï¼Œé»é¸ `TileMap` ç¯€é»ä¸‹çš„é‚£å€‹**åœ–å±¤ (Layer)**ï¼Œä¾‹å¦‚ `Trees` åœ–å±¤ã€‚</li>
                        <li data-lang="solution2_1_Step2">åœ¨ã€å±¬æ€§é¢æ¿ã€‘ä¸­ï¼Œæ‰¾åˆ° <code class="code">Ordering</code> åˆ†é¡ï¼Œä¸¦å‹¾é¸ <code class="code">Y Sort Enabled</code>ã€‚</li>
                        <li data-lang="solution2_1_Step3"><strong class="text-yellow-400">æ³¨æ„ï¼š</strong> æ˜¯åœ¨**åœ–å±¤**ä¸Šå•Ÿç”¨ï¼Œè€Œä¸æ˜¯åœ¨ `TileMap` ä¸»ç¯€é»ä¸Šï¼</li>
                    </ol>
                    
                    <h3 class="font-bold text-lg mt-4" data-lang="solution2Step2Title">ç¬¬äºŒæ­¥ï¼šåœ¨ TileSet ä¸­è¨­å®šç“¦ç‰‡åŸé»</h3>
                    <p data-lang="solution2Step2Desc">ä½ éœ€è¦ç‚ºæ¯ä¸€å€‹éœ€è¦é®æ“‹çš„ç“¦ç‰‡ï¼ˆå¦‚æ¨¹ï¼‰è¨­å®šå®ƒçš„æ’åºã€Œè…³æœ¬ã€ã€‚</p>
                    <ol class="list-decimal list-inside space-y-2">
                        <li data-lang="solution2_2_Step1">åœ¨ç·¨è¼¯å™¨ä¸‹æ–¹ï¼Œæ‰“é–‹ <code class="code">TileSet</code> é¢æ¿ã€‚</li>
                        <li data-lang="solution2_2_Step2">é»é¸ä½ çš„æ¨¹æœ¨ç“¦ç‰‡ã€‚</li>
                        <li data-lang="solution2_2_Step3">åœ¨å³é‚Šçš„å±¬æ€§ä¸­ï¼Œæ‰¾åˆ° <code class="code">Rendering</code> åˆ†é¡ã€‚</li>
                        <li data-lang="solution2_2_Step4">å°‡ <code class="code">Y Sort Origin</code> çš„ Y å€¼è¨­å®šç‚ºä½ ç“¦ç‰‡çš„é«˜åº¦ (ä¾‹å¦‚ï¼Œ16x16 çš„ç“¦ç‰‡å°±è¨­ç‚º 16)ã€‚</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Summary -->
        <div class="card">
            <div class="card-header" data-lang="summaryHeader">ç¸½çµèˆ‡é™¤éŒ¯æ¸…å–®</div>
            <div class="card-body">
                <p data-lang="summaryDesc">ç•¶ Y-Sort å¤±æ•ˆæ™‚ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿæª¢æŸ¥ï¼š</p>
                <ul class="list-disc list-inside space-y-2 mt-4">
                    <li data-lang="summaryCheck1"><strong class="text-green-400">çˆ¶ç¯€é»æª¢æŸ¥ï¼š</strong> æ‰€æœ‰éœ€è¦äº’ç›¸æ’åºçš„ç‰©ä»¶ï¼ˆç©å®¶ã€æ¨¹ã€TileMapï¼‰æ˜¯å¦éƒ½åœ¨åŒä¸€å€‹çˆ¶ç¯€é»ä¸‹ï¼Ÿè©²çˆ¶ç¯€é»æ˜¯å¦å·²å•Ÿç”¨ <code class="code">Y Sort Enabled</code>ï¼Ÿ</li>
                    <li data-lang="summaryCheck2"><strong class="text-green-400">ç‰©ä»¶åŸé»æª¢æŸ¥ï¼š</strong> å°æ–¼ç¨ç«‹çš„ `Sprite2D` ç‰©ä»¶ï¼Œå®ƒçš„ <code class="code">Offset</code> æ˜¯å¦å·²èª¿æ•´åˆ°è…³ä¸‹ï¼Ÿ</li>
                    <li data-lang="summaryCheck3"><strong class="text-green-400">TileMap åœ–å±¤æª¢æŸ¥ï¼š</strong> å°æ–¼ `TileMap`ï¼Œæ˜¯å¦æ˜¯åœ¨**åœ–å±¤**ä¸Šå•Ÿç”¨ <code class="code">Y Sort Enabled</code>ï¼Œè€Œä¸æ˜¯ä¸»ç¯€é»ï¼Ÿ</li>
                    <li data-lang="summaryCheck4"><strong class="text-green-400">TileSet ç“¦ç‰‡æª¢æŸ¥ï¼š</strong> åœ¨ `TileSet` ä¸­ï¼Œé®æ“‹ç‰©ç“¦ç‰‡çš„ <code class="code">Y Sort Origin</code> æ˜¯å¦å·²è¨­å®šï¼Ÿ</li>
                    <li data-lang="summaryCheck5"><strong class="text-green-400">Z Index æª¢æŸ¥ï¼š</strong> æ‰€æœ‰åƒèˆ‡æ’åºçš„ç‰©ä»¶çš„ <code class="code">Z Index</code> æ˜¯å¦éƒ½ç‚º 0ï¼ŸZ Index æœƒè¦†è“‹ Y-Sort çš„æ•ˆæœã€‚</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const translations = {
            'zh-Hant': {
                title: 'æ·±å…¥ç†è§£ Godot çš„ Y-Sort',
                subtitle: 'ä¸€å€‹è§£æ±º 2D æ’åºå•é¡Œçš„äº’å‹•æŒ‡å—',
                demoHeader: 'äº’å‹•ç¯„ä¾‹ï¼šçœ¼è¦‹ç‚ºæ†‘',
                demoHint: 'æç¤ºï¼šç”¨æ»‘é¼ æ‹–æ›³è§’è‰²ä¾†ç§»å‹•',
                demoInstructions: 'è©¦è‘—æ‹–æ›³ã€Œè§’è‰²ã€ï¼Œè®“ä»–å¾ã€Œæ¨¹ã€çš„å‰æ–¹å’Œå¾Œæ–¹ç¶“éï¼Œè§€å¯Ÿä»–çš„åœ–å±¤è®ŠåŒ–ã€‚',
                demoToggleLabel: 'ä¿®æ­£æ’åºåŸé»',
                statusFixed: 'ç‹€æ…‹ï¼šå·²ä¿®æ­£',
                statusDefault: 'ç‹€æ…‹ï¼šé è¨­ (éŒ¯èª¤)',
                problemHeader: 'æ ¸å¿ƒå•é¡Œï¼šä½ ä»¥ç‚ºçš„ã€Œä½ç½®ã€ä¸æ˜¯ Godot ä»¥ç‚ºçš„ä½ç½®',
                problemDesc1: 'ç•¶ä½ å•Ÿç”¨ <code class="code">Y Sort Enabled</code> æ™‚ï¼ŒGodot æœƒæ ¹æ“šå­ç¯€é»çš„ Y åº§æ¨™ä¾†æ±ºå®šç¹ªè£½é †åºï¼šY å€¼è¶Šå¤§ï¼ˆåœ¨ç•«é¢ä¸Šè¶Šä¸‹æ–¹ï¼‰çš„ç¯€é»ï¼Œæœƒè¢«ç•«åœ¨è¶Šä¸Šå±¤ã€‚',
                problemDesc2: 'ä½†é—œéµåœ¨æ–¼ï¼ŒGodot æ¯”è¼ƒçš„ä¸æ˜¯æ•´å€‹åœ–ç‰‡çš„ä½ç½®ï¼Œè€Œæ˜¯æ¯å€‹ç¯€é»çš„ã€ŒåŸé» (Origin)ã€çš„ Y åº§æ¨™ã€‚',
                problemWrongTitle: 'âŒ éŒ¯èª¤çš„æ’åº (é è¨­æƒ…æ³)',
                problemWrongDesc: 'è§’è‰²å’Œæ¨¹çš„åŸé»éƒ½åœ¨å·¦ä¸Šè§’ã€‚ç•¶è§’è‰²åœ¨æ¨¹çš„å‰æ–¹æ™‚ï¼Œä»–çš„åŸé» Y åº§æ¨™æ¯”æ¨¹çš„åŸé»å°ï¼Œæ‰€ä»¥è¢«ç•«åœ¨æ¨¹çš„å¾Œé¢ã€‚',
                problemRightTitle: 'âœ… æ­£ç¢ºçš„æ’åº',
                problemRightDesc: 'å°‡åŸé»ç§»åˆ°ç‰©ä»¶çš„ã€Œè…³ä¸‹ã€ã€‚ç¾åœ¨ç•¶è§’è‰²åœ¨æ¨¹çš„å‰æ–¹æ™‚ï¼Œä»–çš„åŸé» Y åº§æ¨™æ¯”æ¨¹å¤§ï¼Œå› æ­¤è¢«æ­£ç¢ºåœ°ç•«åœ¨æ¨¹çš„å‰é¢ã€‚',
                solutionsHeader: 'è§£æ±ºæ–¹æ¡ˆ',
                solution1Header: 'æ–¹æ³•ä¸€ï¼šé‡å°ç¨ç«‹ç¯€é» (å¦‚ Player, Tree)',
                solution1Desc: 'å°æ–¼ç¨ç«‹çš„å ´æ™¯å¯¦ä¾‹ï¼ˆä¾‹å¦‚ç©å®¶ã€NPCã€å¯æ‹¾å–çš„é“å…·ã€å–®ç¨æ”¾ç½®çš„æ¨¹ï¼‰ï¼Œä½ éœ€è¦èª¿æ•´å®ƒå€‘ Sprite çš„åŸé»ã€‚',
                solution1Step1: 'æ‰“é–‹ä½ çš„ç‰©ä»¶å ´æ™¯ (ä¾‹å¦‚ `Player.tscn` æˆ– `Tree.tscn`)ã€‚',
                solution1Step2: 'åœ¨å ´æ™¯æ¨¹ä¸­é¸æ“‡è² è²¬é¡¯ç¤ºåœ–å½¢çš„ <code class="code">Sprite2D</code> æˆ– <code class="code">AnimatedSprite2D</code> ç¯€é»ã€‚',
                solution1Step3: 'åœ¨å³é‚Šçš„ã€å±¬æ€§é¢æ¿ã€‘ä¸­ï¼Œæ‰¾åˆ° <code class="code">Transform</code> åˆ†é¡ä¸‹çš„ <code class="code">Offset</code> å±¬æ€§ã€‚',
                solution1Step4: 'èª¿æ•´ <code class="code">Offset</code> çš„ Y å€¼ï¼Œå°‡åœ–ç‰‡å‘ä¸Šç§»å‹•ï¼Œç›´åˆ°ç¯€é»çš„åŸé» (é‚£å€‹å°å°çš„åå­—) å°æº–ç‰©ä»¶çš„è…³ä¸‹ã€‚é€šå¸¸ Y å€¼æœƒæ˜¯ä¸€å€‹è² æ•¸ã€‚',
                solution1TipTitle: 'ğŸ’¡ æç¤ºï¼š',
                solution1TipDesc: 'åœ¨ 2D è¦–åœ–ä¸­ï¼Œé¸æ“‡ç§»å‹•å·¥å…· (W)ï¼Œç„¶å¾ŒæŒ‰ä½ <code class="code">Alt</code> éµæ‹–æ›³ä½ çš„ Spriteã€‚é€™æ¨£å¯ä»¥ç›´æ¥ä¿®æ”¹ Offsetï¼Œéå¸¸ç›´è§€ã€‚',
                solution2Header: 'æ–¹æ³•äºŒï¼šé‡å° TileMap',
                solution2Desc: 'ç•¶ä½ çš„é®æ“‹ç‰©ï¼ˆä¾‹å¦‚æ¨¹ã€ç‰†å£ï¼‰æ˜¯ç•«åœ¨ <code class="code">TileMap</code> ä¸Šæ™‚ï¼Œè¨­å®šæœƒç¨å¾®ä¸åŒï¼Œéœ€è¦å…©æ­¥é—œéµæ“ä½œã€‚',
                solution2Step1Title: 'ç¬¬ä¸€æ­¥ï¼šåœ¨ TileMap åœ–å±¤ä¸Šå•Ÿç”¨ Y-Sort',
                solution2Step1Desc: 'ä½ éœ€è¦å‘Šè¨´ Godotï¼Œé€™å€‹åœ–å±¤ä¸Šçš„ç“¦ç‰‡éœ€è¦å½¼æ­¤ä¹‹é–“é€²è¡Œ Y è»¸æ’åºã€‚',
                solution2_1_Step1: 'åœ¨ä½ çš„ä¸»å ´æ™¯ä¸­ï¼Œé»é¸ `TileMap` ç¯€é»ä¸‹çš„é‚£å€‹**åœ–å±¤ (Layer)**ï¼Œä¾‹å¦‚ `Trees` åœ–å±¤ã€‚',
                solution2_1_Step2: 'åœ¨ã€å±¬æ€§é¢æ¿ã€‘ä¸­ï¼Œæ‰¾åˆ° <code class="code">Ordering</code> åˆ†é¡ï¼Œä¸¦å‹¾é¸ <code class="code">Y Sort Enabled</code>ã€‚',
                solution2_1_Step3: '<strong class="text-yellow-400">æ³¨æ„ï¼š</strong> æ˜¯åœ¨**åœ–å±¤**ä¸Šå•Ÿç”¨ï¼Œè€Œä¸æ˜¯åœ¨ `TileMap` ä¸»ç¯€é»ä¸Šï¼',
                solution2Step2Title: 'ç¬¬äºŒæ­¥ï¼šåœ¨ TileSet ä¸­è¨­å®šç“¦ç‰‡åŸé»',
                solution2Step2Desc: 'ä½ éœ€è¦ç‚ºæ¯ä¸€å€‹éœ€è¦é®æ“‹çš„ç“¦ç‰‡ï¼ˆå¦‚æ¨¹ï¼‰è¨­å®šå®ƒçš„æ’åºã€Œè…³æœ¬ã€ã€‚',
                solution2_2_Step1: 'åœ¨ç·¨è¼¯å™¨ä¸‹æ–¹ï¼Œæ‰“é–‹ <code class="code">TileSet</code> é¢æ¿ã€‚',
                solution2_2_Step2: 'é»é¸ä½ çš„æ¨¹æœ¨ç“¦ç‰‡ã€‚',
                solution2_2_Step3: 'åœ¨å³é‚Šçš„å±¬æ€§ä¸­ï¼Œæ‰¾åˆ° <code class="code">Rendering</code> åˆ†é¡ã€‚',
                solution2_2_Step4: 'å°‡ <code class="code">Y Sort Origin</code> çš„ Y å€¼è¨­å®šç‚ºä½ ç“¦ç‰‡çš„é«˜åº¦ (ä¾‹å¦‚ï¼Œ16x16 çš„ç“¦ç‰‡å°±è¨­ç‚º 16)ã€‚',
                summaryHeader: 'ç¸½çµèˆ‡é™¤éŒ¯æ¸…å–®',
                summaryDesc: 'ç•¶ Y-Sort å¤±æ•ˆæ™‚ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿæª¢æŸ¥ï¼š',
                summaryCheck1: '<strong class="text-green-400">çˆ¶ç¯€é»æª¢æŸ¥ï¼š</strong> æ‰€æœ‰éœ€è¦äº’ç›¸æ’åºçš„ç‰©ä»¶ï¼ˆç©å®¶ã€æ¨¹ã€TileMapï¼‰æ˜¯å¦éƒ½åœ¨åŒä¸€å€‹çˆ¶ç¯€é»ä¸‹ï¼Ÿè©²çˆ¶ç¯€é»æ˜¯å¦å·²å•Ÿç”¨ <code class="code">Y Sort Enabled</code>ï¼Ÿ',
                summaryCheck2: '<strong class="text-green-400">ç‰©ä»¶åŸé»æª¢æŸ¥ï¼š</strong> å°æ–¼ç¨ç«‹çš„ `Sprite2D` ç‰©ä»¶ï¼Œå®ƒçš„ <code class="code">Offset</code> æ˜¯å¦å·²èª¿æ•´åˆ°è…³ä¸‹ï¼Ÿ',
                summaryCheck3: '<strong class="text-green-400">TileMap åœ–å±¤æª¢æŸ¥ï¼š</strong> å°æ–¼ `TileMap`ï¼Œæ˜¯å¦æ˜¯åœ¨**åœ–å±¤**ä¸Šå•Ÿç”¨ <code class="code">Y Sort Enabled</code>ï¼Œè€Œä¸æ˜¯ä¸»ç¯€é»ï¼Ÿ',
                summaryCheck4: '<strong class="text-green-400">TileSet ç“¦ç‰‡æª¢æŸ¥ï¼š</strong> åœ¨ `TileSet` ä¸­ï¼Œé®æ“‹ç‰©ç“¦ç‰‡çš„ <code class="code">Y Sort Origin</code> æ˜¯å¦å·²è¨­å®šï¼Ÿ',
                summaryCheck5: '<strong class="text-green-400">Z Index æª¢æŸ¥ï¼š</strong> æ‰€æœ‰åƒèˆ‡æ’åºçš„ç‰©ä»¶çš„ <code class="code">Z Index</code> æ˜¯å¦éƒ½ç‚º 0ï¼ŸZ Index æœƒè¦†è“‹ Y-Sort çš„æ•ˆæœã€‚',
                playerName: 'è§’è‰²',
                treeName: 'æ¨¹',
                langBtn: 'English',
            },
            'en': {
                title: 'Deep Dive into Godot\'s Y-Sort',
                subtitle: 'An Interactive Guide to Solving 2D Sorting Problems',
                demoHeader: 'Interactive Demo: Seeing is Believing',
                demoHint: 'Hint: Drag the character with your mouse to move.',
                demoInstructions: 'Try dragging the "Character" to pass in front of and behind the "Tree" to observe the layer changes.',
                demoToggleLabel: 'Fix Sort Origin',
                statusFixed: 'Status: Fixed',
                statusDefault: 'Status: Default (Incorrect)',
                problemHeader: 'The Core Problem: Your "Position" vs. Godot\'s "Position"',
                problemDesc1: 'When you enable <code class="code">Y Sort Enabled</code>, Godot decides the drawing order based on the Y coordinate of its child nodes: nodes with a larger Y value (further down the screen) are drawn on top.',
                problemDesc2: 'The key, however, is that Godot compares the Y coordinate of each node\'s "Origin", not the position of the entire sprite.',
                problemWrongTitle: 'âŒ Incorrect Sorting (Default)',
                problemWrongDesc: 'The origins of the character and the tree are at their top-left corners. When the character is in front of the tree, its origin\'s Y coordinate is smaller than the tree\'s, so it\'s drawn behind the tree.',
                problemRightTitle: 'âœ… Correct Sorting',
                problemRightDesc: 'Move the origin to the "feet" of the objects. Now, when the character is in front of the tree, its origin\'s Y coordinate is larger, so it\'s correctly drawn on top.',
                solutionsHeader: 'Solutions',
                solution1Header: 'Method 1: For Standalone Nodes (e.g., Player, Tree)',
                solution1Desc: 'For standalone scene instances (like players, NPCs, items, individual trees), you need to adjust their Sprite\'s origin.',
                solution1Step1: 'Open your object\'s scene (e.g., `Player.tscn` or `Tree.tscn`).',
                solution1Step2: 'In the scene tree, select the <code class="code">Sprite2D</code> or <code class="code">AnimatedSprite2D</code> node responsible for the graphics.',
                solution1Step3: 'In the Inspector on the right, find the <code class="code">Offset</code> property under the <code class="code">Transform</code> category.',
                solution1Step4: 'Adjust the Y value of the <code class="code">Offset</code> to move the texture upwards until the node\'s origin (the small cross) is at the object\'s feet. The Y value will typically be negative.',
                solution1TipTitle: 'ğŸ’¡ Pro Tip:',
                solution1TipDesc: 'In the 2D viewport, select the Move Tool (W), then hold down the <code class="code">Alt</code> key while dragging your Sprite. This directly modifies the Offset, which is very intuitive.',
                solution2Header: 'Method 2: For TileMaps',
                solution2Desc: 'When your obstacles (like trees or walls) are drawn on a <code class="code">TileMap</code>, the setup is slightly different and requires two key steps.',
                solution2Step1Title: 'Step 1: Enable Y-Sort on the TileMap Layer',
                solution2Step1Desc: 'You need to tell Godot that the tiles on this layer should be Y-sorted among themselves.',
                solution2_1_Step1: 'In your main scene, select the **layer** under the `TileMap` node, for example, the `Trees` layer.',
                solution2_1_Step2: 'In the Inspector, find the <code class="code">Ordering</code> category and check <code class="code">Y Sort Enabled</code>.',
                solution2_1_Step3: '<strong class="text-yellow-400">Note:</strong> Enable it on the **layer**, not on the main `TileMap` node!',
                solution2Step2Title: 'Step 2: Set Tile Origin in the TileSet',
                solution2Step2Desc: 'You need to define the sorting "base" for each obstacle tile (like a tree).',
                solution2_2_Step1: 'At the bottom of the editor, open the <code class="code">TileSet</code> panel.',
                solution2_2_Step2: 'Click on your tree tile.',
                solution2_2_Step3: 'In the properties on the right, find the <code class="code">Rendering</code> category.',
                solution2_2_Step4: 'Set the Y value of the <code class="code">Y Sort Origin</code> to your tile\'s height (e.g., set it to 16 for a 16x16 tile).',
                summaryHeader: 'Summary & Debugging Checklist',
                summaryDesc: 'When Y-Sort fails, check the following steps:',
                summaryCheck1: '<strong class="text-green-400">Parent Node Check:</strong> Are all objects to be sorted (Player, Trees, TileMap) direct children of the same parent node? Is <code class="code">Y Sort Enabled</code> on that parent?',
                summaryCheck2: '<strong class="text-green-400">Object Origin Check:</strong> For standalone `Sprite2D` objects, is their <code class="code">Offset</code> adjusted to their feet?',
                summaryCheck3: '<strong class="text-green-400">TileMap Layer Check:</strong> For `TileMap`, is <code class="code">Y Sort Enabled</code> on the **layer**, not the main node?',
                summaryCheck4: '<strong class="text-green-400">TileSet Tile Check:</strong> In the `TileSet`, is the <code class="code">Y Sort Origin</code> set for the obstacle tiles?',
                summaryCheck5: '<strong class="text-green-400">Z Index Check:</strong> Is the <code class="code">Z Index</code> of all sorted objects set to 0? Z Index overrides Y-Sort.',
                playerName: 'Character',
                treeName: 'Tree',
                langBtn: 'ä¸­æ–‡',
            }
        };

        const canvas = document.getElementById('demoCanvas');
        const ctx = canvas.getContext('2d');
        const toggle = document.getElementById('fixOriginToggle');
        const statusText = document.getElementById('statusText');
        const langSwitcher = document.getElementById('langSwitcher');

        let currentLanguage = 'zh-Hant';
        let useFixedOrigin = false;

        const player = { x: 180, y: 200, width: 40, height: 60, color: '#3b82f6' };
        const tree = { x: 150, y: 100, width: 100, height: 120, color: '#16a34a' };
        
        let isDragging = false;
        let dragOffsetX, dragOffsetY;

        function setLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.lang = lang;
            document.querySelectorAll('[data-lang]').forEach(el => {
                const key = el.dataset.lang;
                if (translations[lang][key]) {
                    el.innerHTML = translations[lang][key];
                }
            });
            langSwitcher.textContent = translations[lang].langBtn;
        }

        function drawObject(obj) {
            const name = obj === player ? translations[currentLanguage].playerName : translations[currentLanguage].treeName;
            ctx.fillStyle = obj.color;
            ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
            
            ctx.fillStyle = 'white';
            ctx.font = '14px Inter, Noto Sans TC';
            ctx.textAlign = 'center';
            ctx.fillText(name, obj.x + obj.width / 2, obj.y + obj.height / 2);

            ctx.fillStyle = 'red';
            ctx.beginPath();
            const originY = useFixedOrigin ? obj.y + obj.height : obj.y;
            ctx.arc(obj.x, originY, 5, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = 'yellow';
            ctx.font = '12px monospace';
            ctx.fillText(`y: ${Math.round(originY)}`, obj.x, originY - 10);
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const objects = [player, tree];

            objects.sort((a, b) => {
                const yA = useFixedOrigin ? a.y + a.height : a.y;
                const yB = useFixedOrigin ? b.y + b.height : b.y;
                return yA - yB;
            });

            objects.forEach(drawObject);
            
            if (useFixedOrigin) {
                statusText.innerHTML = translations[currentLanguage].statusFixed;
                statusText.className = 'text-center font-bold text-xl p-2 rounded-lg bg-green-700 text-green-100';
            } else {
                statusText.innerHTML = translations[currentLanguage].statusDefault;
                statusText.className = 'text-center font-bold text-xl p-2 rounded-lg bg-red-700 text-red-100';
            }

            requestAnimationFrame(gameLoop);
        }

        toggle.addEventListener('change', (e) => {
            useFixedOrigin = e.target.checked;
        });
        
        langSwitcher.addEventListener('click', () => {
            const newLang = currentLanguage === 'zh-Hant' ? 'en' : 'zh-Hant';
            setLanguage(newLang);
        });
        
        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            if (mouseX >= player.x && mouseX <= player.x + player.width &&
                mouseY >= player.y && mouseY <= player.y + player.height) {
                isDragging = true;
                dragOffsetX = mouseX - player.x;
                dragOffsetY = mouseY - player.y;
            }
        });

        canvas.addEventListener('mouseup', () => { isDragging = false; });
        canvas.addEventListener('mouseout', () => { isDragging = false; });

        canvas.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const rect = canvas.getBoundingClientRect();
                player.x = e.clientX - rect.left - dragOffsetX;
                player.y = e.clientY - rect.top - dragOffsetY;
            }
        });

        // Initial setup
        setLanguage(currentLanguage);
        gameLoop();
    </script>
</body>
</html>