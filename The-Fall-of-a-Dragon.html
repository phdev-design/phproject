<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊùéÂ∞èÈæçÊ≠ªÂõ†Ëß£ÊßãÔºöÈÜ´Â≠∏Ë¨éÂúòÁöÑÊúÄÁµÇÁ≠îÊ°à</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Roboto:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', 'Noto Sans TC', sans-serif;
            background-color: #0F172A; 
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .stat-card h3 {
            color: #48C2D4;
        }
        .flowchart-arrow {
            font-size: 2rem;
            color: #48C2D4;
            line-height: 1;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -31px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #48C2D4;
            border: 4px solid #1E293B;
        }
        .lang-switcher button.active {
            background-color: #48C2D4;
            color: #0F172A;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-200">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-6xl font-black text-white mb-2" data-lang-key="header_title"></h1>
            <p class="text-xl md:text-2xl text-cyan-300" data-lang-key="header_subtitle"></p>
        </header>

        <div class="lang-switcher flex justify-center mb-12 space-x-2">
            <button onclick="switchLanguage('zh')" id="lang-btn-zh" class="px-4 py-2 rounded-md bg-slate-700 text-white transition-colors duration-300">ÁπÅÈ´î‰∏≠Êñá</button>
            <button onclick="switchLanguage('en')" id="lang-btn-en" class="px-4 py-2 rounded-md bg-slate-700 text-white transition-colors duration-300">English</button>
        </div>

        <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            <section class="lg:col-span-2 bg-slate-800 rounded-lg shadow-2xl p-6">
                <h2 class="text-3xl font-bold text-white mb-4 text-center" data-lang-key="section1_title"></h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                    <div class="stat-card text-center p-4">
                        <h3 class="text-2xl font-bold mb-2" data-lang-key="section1_card1_title"></h3>
                        <p class="text-slate-300" data-lang-key="section1_card1_text"></p>
                    </div>
                    <div class="stat-card text-center p-4">
                        <p class="text-7xl font-black text-white">+13%</p>
                        <h3 class="text-2xl font-bold mt-2" data-lang-key="section1_card2_title"></h3>
                        <p class="text-slate-300" data-lang-key="section1_card2_text"></p>
                    </div>
                    <div class="chart-container h-64 md:h-auto">
                         <canvas id="equagesicChart"></canvas>
                         <p class="text-center text-sm text-slate-400 mt-2" data-lang-key="section1_chart_caption"></p>
                    </div>
                </div>
                 <div class="mt-6 p-4 bg-slate-900 rounded-lg">
                    <h4 class="font-bold text-lg text-red-400 text-center" data-lang-key="section1_doubt_title"></h4>
                    <ul class="list-inside list-disc text-slate-300 mt-2 space-y-1 text-center">
                        <li data-lang-key="section1_doubt_1"></li>
                        <li data-lang-key="section1_doubt_2"></li>
                        <li data-lang-key="section1_doubt_3"></li>
                        <li data-lang-key="section1_doubt_4"></li>
                    </ul>
                </div>
            </section>

            <section class="lg:col-span-2 bg-slate-800 rounded-lg shadow-2xl p-6">
                <h2 class="text-3xl font-bold text-white mb-6 text-center" data-lang-key="section2_title"></h2>
                <div class="relative border-l-4 border-slate-700 ml-8 md:ml-4 py-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="mb-8 pl-8 relative timeline-item">
                            <h3 class="text-2xl font-bold text-cyan-300">1973-05-10</h3>
                            <p class="font-bold text-lg text-white" data-lang-key="section2_event1_title"></p>
                            <ul class="mt-2 text-slate-300 space-y-1">
                                <li><span class="font-bold text-amber-400" data-lang-key="location"></span>: <span data-lang-key="section2_event1_location"></span></li>
                                <li><span class="font-bold text-amber-400" data-lang-key="symptoms"></span>: <span data-lang-key="section2_event1_symptoms"></span></li>
                                <li><span class="font-bold text-amber-400" data-lang-key="diagnosis"></span>: <span data-lang-key="section2_event1_diagnosis"></span></li>
                                <li><span class="font-bold text-green-400" data-lang-key="treatment"></span>: <span data-lang-key="section2_event1_treatment"></span></li>
                                <li><span class="font-bold text-red-400" data-lang-key="clue"></span>: <span data-lang-key="section2_event1_clue"></span></li>
                            </ul>
                        </div>
                        <div class="mb-4 pl-8 relative timeline-item">
                            <h3 class="text-2xl font-bold text-cyan-300">1973-07-20</h3>
                            <p class="font-bold text-lg text-white" data-lang-key="section2_event2_title"></p>
                            <ul class="mt-2 text-slate-300 space-y-1">
                                <li><span class="font-bold text-amber-400" data-lang-key="location"></span>: <span data-lang-key="section2_event2_location"></span></li>
                                <li><span class="font-bold text-amber-400" data-lang-key="symptoms"></span>: <span data-lang-key="section2_event2_symptoms"></span></li>
                                <li><span class="font-bold text-amber-400" data-lang-key="diagnosis"></span>: <span data-lang-key="section2_event2_diagnosis"></span></li>
                                <li><span class="font-bold text-red-400" data-lang-key="result"></span>: <span data-lang-key="section2_event2_result"></span></li>
                                <li><span class="font-bold text-slate-400" data-lang-key="factor"></span>: <span data-lang-key="section2_event2_factor"></span></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <p class="text-center mt-4 text-slate-400" data-lang-key="section2_conclusion"></p>
            </section>

            <section class="lg:col-span-2 bg-slate-800 rounded-lg shadow-2xl p-6">
                <h2 class="text-3xl font-bold text-white mb-6 text-center" data-lang-key="section3_title"></h2>
                <p class="text-center text-slate-300 mb-6 max-w-3xl mx-auto" data-lang-key="section3_subtitle"></p>
                <div class="chart-container" style="max-width: 800px; height: 400px;">
                    <canvas id="theoryComparisonChart"></canvas>
                </div>
                <p class="text-center mt-4 text-slate-300" data-lang-key="section3_conclusion"></p>
            </section>

            <section class="lg:col-span-2 bg-slate-800 rounded-lg shadow-2xl p-6">
                <h2 class="text-3xl font-bold text-white mb-2 text-center" data-lang-key="section4_title"></h2>
                <p class="text-center text-slate-300 mb-6 max-w-3xl mx-auto" data-lang-key="section4_subtitle"></p>
                
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 p-4">
                    <div class="text-center p-4 bg-slate-900 rounded-lg">
                        <h4 class="text-lg font-bold text-cyan-300 mb-2" data-lang-key="section4_box1_title"></h4>
                        <div class="flex justify-center flex-wrap gap-4">
                            <div class="text-center">
                                <span class="text-4xl">üíß</span>
                                <p class="text-sm" data-lang-key="section4_risk1"></p>
                            </div>
                            <div class="text-center">
                                <span class="text-4xl">üåø</span>
                                <p class="text-sm" data-lang-key="section4_risk2"></p>
                            </div>
                             <div class="text-center">
                                <span class="text-4xl">üíä</span>
                                <p class="text-sm" data-lang-key="section4_risk3"></p>
                            </div>
                            <div class="text-center">
                                <span class="text-4xl">üí™</span>
                                <p class="text-sm" data-lang-key="section4_risk4"></p>
                            </div>
                        </div>
                    </div>

                    <div class="flowchart-arrow hidden md:block">‚Üí</div>
                    <div class="flowchart-arrow md:hidden">‚Üì</div>

                    <div class="text-center p-4 bg-slate-900 rounded-lg">
                        <h4 class="text-lg font-bold text-cyan-300 mb-2" data-lang-key="section4_box2_title"></h4>
                         <p class="text-slate-300" data-lang-key="section4_process"></p>
                    </div>
                </div>
            </section>
            
            <footer class="lg:col-span-2 text-center mt-8 p-6 bg-slate-800 rounded-lg shadow-2xl">
                <h2 class="text-3xl font-bold text-white mb-4" data-lang-key="footer_title"></h2>
                <p class="text-lg text-slate-300 max-w-prose mx-auto" data-lang-key="footer_text"></p>
            </footer>

        </main>
    </div>

    <script>
        let equagesicChartInstance;
        let theoryComparisonChartInstance;

        const translations = {
            zh: {
                header_title: "‰∏Ä‰ª£Â∑®ÈæçÁöÑÊÆûËêΩ",
                header_subtitle: "ÊùéÂ∞èÈæçÊ≠ªÂõ†‰πãË¨éÔºöÁßëÂ≠∏Ë≠âÊìöÁöÑÊúÄÁµÇÂØ©Âà§",
                section1_title: "Ë¨éÂúòÁöÑÈñãÁ´ØÔºö1973Âπ¥ÁöÑÂÆòÊñπË£ÅÊ±∫",
                section1_card1_title: "Ê≠ªÊñºÈùûÂëΩ",
                section1_card1_text: "1973Âπ¥Ê≠ªÂõ†Â∫≠Ë£ÅÂÆöÔºåÊùéÂ∞èÈæçÊ≠ªÊñºÂ∞çÊ≠¢ÁóõËó•EquagesicÁöÑÈÅéÊïèÂèçÊáâÔºåÂ±¨ÊÑèÂ§ñÊ≠ª‰∫°„ÄÇ",
                section1_card2_title: "ÊÄ•ÊÄßËÖ¶Ê∞¥ËÖ´",
                section1_card2_text: "È©óÂ±çÂ†±ÂëäÈ°ØÁ§∫ÂÖ∂Â§ßËÖ¶Áî±Ê≠£Â∏∏1400ÂÖãÂ¢ûËá≥1575ÂÖãÔºåÂö¥ÈáçËÖ´ËÑπ„ÄÇ",
                section1_chart_caption: "ÂÆòÊñπË™çÂÆöÁöÑ„ÄåÂÖÉÂÖá„ÄçÔºöEquagesicÊàêÂàÜ",
                section1_doubt_title: "‰ΩÜÔºåÈÄôÂÄãË£ÅÊ±∫ÂÖÖÊªøÁñëÈªû...",
                section1_doubt_1: "ÊùéÂ∞èÈæçÊõæÊúçÁî®ÈÅéË©≤Ëó•ÂçªÁÑ°‰∫ã„ÄÇ",
                section1_doubt_2: "È†≠ÁóõÔºàËÖ¶Ê∞¥ËÖ´ÁóáÁãÄÔºâÂú®ÊúçËó•ÂâçÂ∑≤Âá∫Áèæ„ÄÇ",
                section1_doubt_3: "Â±çÊ™¢Áº∫‰πèÈÅéÊïèÂèçÊáâÁöÑÂÖ∏ÂûãË≠âÊìö„ÄÇ",
                section1_doubt_4: "ÊúÄÈóúÈçµÔºöÊ≠ªÂâçÂÖ©ÂÄãÊúàÁöÑÂè¶‰∏ÄÊ¨°ËÖ¶Ê∞¥ËÖ´‰∫ã‰ª∂‰∏≠Ôºå‰∏¶Êú™ÊúçÁî®Ê≠§Ëó•„ÄÇ",
                section2_title: "ÊÇ≤ÂäáÁöÑÈ†êÊºîÔºöÂÖ©Ê¨°Ëá¥ÂëΩÁöÑËÖ¶Ê∞¥ËÖ´‰∫ã‰ª∂",
                section2_event1_title: "È¶ñÊ¨°ËôõËÑ´ (ÂÄñÂ≠ò)",
                location: "Âú∞Èªû",
                symptoms: "ÁóáÁãÄ",
                diagnosis: "Ë®∫Êñ∑",
                treatment: "ÈóúÈçµÊ≤ªÁôÇ",
                clue: "ÈáçË¶ÅÁ∑öÁ¥¢",
                result: "ÁµêÊûú",
                factor: "Âπ≤ÊìæÂõ†Á¥†",
                section2_event1_location: "ÊÇ∂ÁÜ±ÁöÑÈÖçÈü≥ÂÆ§",
                section2_event1_symptoms: "ÊöàÂÄí„ÄÅÊäΩÊêê„ÄÅÂòîÂêê",
                section2_event1_diagnosis: "ÊÄ•ÊÄßËÖ¶Ê∞¥ËÖ´",
                section2_event1_treatment: "Ê≥®Â∞ÑÂà©Â∞øÂäëÁîòÈú≤ÈÜá (Mannitol)",
                section2_event1_clue: "Êú™ÊúçÁî®Equagesic",
                section2_event2_title: "‰∫åÊ¨°Áôº‰Ωú (ÊÆûÂëΩ)",
                section2_event2_location: "‰∏ÅÁèÆÂØìÊâÄ",
                section2_event2_symptoms: "È†≠Áóõ„ÄÅÊöàÁú©ÔºåÈö®ÂæåÊòèËø∑",
                section2_event2_diagnosis: "ÊÄ•ÊÄßËÖ¶Ê∞¥ËÖ´",
                section2_event2_result: "ÈÄÅÈô¢ÂæåË≠âÂØ¶Ê≠ª‰∫°",
                section2_event2_factor: "ÊúçÁî®‰∫ÜEquagesic",
                section2_conclusion: "ÂÖ©Ê¨°‰∫ã‰ª∂ÁöÑÁóÖÁêÜÊ†∏ÂøÉÁõ∏ÂêåÔºåË≠âÊòéÂ≠òÂú®‰∏ÄÂÄãËàáEquagesicÁÑ°ÈóúÁöÑ„ÄÅÂèçË¶ÜÁôº‰ΩúÁöÑÊ†πÊú¨ÂïèÈ°å„ÄÇ",
                section3_title: "Áèæ‰ª£ÁßëÂ≠∏ÂÅáË™™Â∞çÊ±∫",
                section3_subtitle: "Èö®ËëóÈÜ´Â≠∏ÈÄ≤Ê≠•ÔºåÂ§öÂÄãÁêÜË´ñË©¶ÂúñËß£ÈáãÁúüÁõ∏„ÄÇ‰∏ãÂúñÊØîËºÉ‰∫Ü‰∏âÂ§ß‰∏ªÊµÅÁêÜË´ñÂ∞çÈóúÈçµË≠âÊìöÁöÑËß£ÈáãÂäõ„ÄÇ",
                section3_conclusion: "ÁµêË´ñÈ°ØËÄåÊòìË¶ãÔºö‰ΩéË°ÄÈàâÁóáÂÅáË™™Êèê‰æõ‰∫ÜÊúÄÂÖ®Èù¢„ÄÅÊúÄ‰∏ÄËá¥ÁöÑËß£Èáã„ÄÇ",
                section4_title: "ÊúÄÁµÇÁ≠îÊ°àÔºö‰ΩéË°ÄÈàâÁóá (Hyponatremia)",
                section4_subtitle: "ÈÄôÊòØ2022Âπ¥Áî±ËÖéËáüÂ∞àÂÆ∂ÊèêÂá∫ÁöÑÊúÄÊñ∞„ÄÅÊúÄÊ¨äÂ®ÅÁêÜË´ñ„ÄÇÊùéÂ∞èÈæçÁöÑÊ≠ªÂõ†Ê•µÂèØËÉΩÊòØËÖéËáüÁÑ°Ê≥ïÂèäÊôÇÊéíÂá∫Ë∂≥Â§†ÁöÑÊ∞¥ÂàÜÔºåÂ∞éËá¥È´îÂÖßÊ∞¥ÂàÜËàáÈõªËß£Ë≥™Ëá¥ÂëΩÂ§±Ë°°„ÄÇ",
                section4_box1_title: "Â§öÈáçÈ¢®Èö™Âõ†Á¥†ÁñäÂä†",
                section4_risk1: "Â§ßÈáèÈ£≤Ê∞¥<br>&ÊµÅË≥™È£≤È£ü",
                section4_risk2: "‰ΩøÁî®Â§ßÈ∫ª<br>Â¢ûÂä†Âè£Ê∏¥",
                section4_risk3: "Ëó•Áâ©ÂΩ±Èüø<br>ËÖéÂäüËÉΩ",
                section4_risk4: "ÂäáÁÉàÈÅãÂãï<br>Ê∞¥ÂàÜÊªØÁïô",
                section4_box2_title: "Ëá¥ÂëΩÁöÑÁîüÁêÜÈÅéÁ®ã",
                section4_process: "Ê∞¥ÂàÜÊîùÂÖ• > ËÖéËáüÊéíÂá∫ËÉΩÂäõ ‚Üí Ë°ÄÊ∂≤ÈàâÊøÉÂ∫¶ÈÅé‰Ωé ‚Üí Ê∞¥ÂàÜÊπßÂÖ•ËÖ¶Á¥∞ËÉû ‚Üí ÊÄ•ÊÄßËÖ¶Ê∞¥ËÖ´ ‚Üí Ê≠ª‰∫°",
                footer_title: "ÊÇ≤ÂäáÊÄßÁöÑË´∑Âà∫",
                footer_text: "‰∏Ä‰ΩçÂ∞á„Äå<span class=\"text-cyan-300 font-bold\">Be water, my friend</span>„ÄçÔºàÂ¶ÇÊ∞¥‰∏ÄËà¨ÔºåÊàëÁöÑÊúãÂèãÔºâ‰ΩúÁÇ∫‰∫∫ÁîüÂì≤Â≠∏ÁöÑÂ∑®ÊòüÔºåÊúÄÁµÇÊ•µÊúâÂèØËÉΩÂõ†È´îÂÖß„ÄåÊ∞¥„ÄçÁöÑËá¥ÂëΩÂ§±Ë°°ËÄåÂÄí‰∏ã„ÄÇ‰ªñÁöÑÊÆûËêΩÔºå‰∏çÂÉÖÊòØ‰∏ÄÂÄãÊôÇ‰ª£ÁöÑÊêçÂ§±Ôºå‰πüÊòØ‰∏ÄÂâáÈóúÊñº‰∫∫È´îÁîüÁêÜÊ•µÈôêÁöÑÊ∑±ÂàªË≠¶Á§∫„ÄÇ",
                equagesic_chart_title: "Equagesic ÊàêÂàÜ",
                equagesic_aspirin: "ÈòøÊñØÂåπÈùà (Aspirin)",
                equagesic_meprobamate: "ÂÆâÂØß (Meprobamate)",
                theory_chart_title: "‰∏âÂ§ß‰∏ªÊµÅÁêÜË´ñËß£ÈáãÂäõÂ∞çÊØî",
                theory_chart_x_axis: "Ëß£ÈáãÂäõË©ïÂàÜ (1-10)",
                theory_chart_allergy: "EquagesicÈÅéÊïèË´ñ",
                theory_chart_heatstroke: "‰∏≠ÊöëË´ñ",
                theory_chart_hyponatremia: "‰ΩéË°ÄÈàâÁóáË´ñ",
                theory_chart_y_axis_1: "Ëß£Èáã5Êúà10Êó•‰∫ã‰ª∂",
                theory_chart_y_axis_2: "Á¨¶ÂêàÂ±çÊ™¢ÁµêÊûú",
                theory_chart_y_axis_3: "Êï¥ÂêàÁîüÊ¥ªÈ¢®Èö™",
            },
            en: {
                header_title: "The Fall of a Dragon",
                header_subtitle: "The Mystery of Bruce Lee's Death: The Final Verdict of Science",
                section1_title: "The Beginning of the Mystery: The Official 1973 Ruling",
                section1_card1_title: "Death by Misadventure",
                section1_card1_text: "The 1973 inquest ruled Bruce Lee's death an accident caused by an allergic reaction to the painkiller Equagesic.",
                section1_card2_title: "Acute Cerebral Edema",
                section1_card2_text: "The autopsy showed his brain had swollen from a normal 1400g to 1575g.",
                section1_chart_caption: "The Official 'Culprit': Equagesic Components",
                section1_doubt_title: "But, this ruling was full of doubts...",
                section1_doubt_1: "Lee had taken the drug before without issue.",
                section1_doubt_2: "The headache (a symptom of edema) appeared before he took the drug.",
                section1_doubt_3: "The autopsy lacked typical evidence of a fatal allergic reaction.",
                section1_doubt_4: "Crucially, he did not take this drug during another edema episode two months prior.",
                section2_title: "A Tragic Rehearsal: Two Fatal Cerebral Edema Events",
                section2_event1_title: "First Collapse (Survived)",
                location: "Location",
                symptoms: "Symptoms",
                diagnosis: "Diagnosis",
                treatment: "Key Treatment",
                clue: "Key Clue",
                result: "Result",
                factor: "Confounding Factor",
                section2_event1_location: "A stuffy dubbing room",
                section2_event1_symptoms: "Fainting, convulsions, vomiting",
                section2_event1_diagnosis: "Acute Cerebral Edema",
                section2_event1_treatment: "Injection of the diuretic Mannitol",
                section2_event1_clue: "Did not take Equagesic",
                section2_event2_title: "Second Attack (Fatal)",
                section2_event2_location: "Betty Ting Pei's apartment",
                section2_event2_symptoms: "Headache, dizziness, then coma",
                section2_event2_diagnosis: "Acute Cerebral Edema",
                section2_event2_result: "Pronounced dead on arrival at hospital",
                section2_event2_factor: "Took Equagesic",
                section2_conclusion: "The core pathology of both events was identical, proving a recurring, underlying problem unrelated to Equagesic.",
                section3_title: "Modern Scientific Hypotheses Face Off",
                section3_subtitle: "As medicine advanced, new theories emerged. The chart below compares how well the three main theories explain the key evidence.",
                section3_conclusion: "The conclusion is clear: the hyponatremia hypothesis provides the most comprehensive and consistent explanation.",
                section4_title: "The Final Answer: Hyponatremia",
                section4_subtitle: "This is the latest and most authoritative theory, proposed by kidney specialists in 2022. Lee's death was most likely caused by his kidneys' inability to excrete enough water, leading to a fatal imbalance.",
                section4_box1_title: "A Cascade of Risk Factors",
                section4_risk1: "High intake of water<br>& liquid diet",
                section4_risk2: "Cannabis use<br>increasing thirst",
                section4_risk3: "Drugs affecting<br>kidney function",
                section4_risk4: "Intense exercise<br>causing water retention",
                section4_box2_title: "The Fatal Physiological Process",
                section4_process: "Water Intake > Kidney Excretion Capacity ‚Üí Low Blood Sodium ‚Üí Water Floods Brain Cells ‚Üí Acute Cerebral Edema ‚Üí Death",
                footer_title: "A Tragic Irony",
                footer_text: "A global icon whose philosophy was \"<span class='text-cyan-300 font-bold'>Be water, my friend</span>,\" likely succumbed to a fatal imbalance of 'water' in his own body. His fall is not just the loss of an era, but a profound lesson on the limits of human physiology.",
                equagesic_chart_title: "Equagesic Components",
                equagesic_aspirin: "Aspirin",
                equagesic_meprobamate: "Meprobamate",
                theory_chart_title: "Explanatory Power of Main Theories",
                theory_chart_x_axis: "Explanatory Score (1-10)",
                theory_chart_allergy: "Equagesic Allergy",
                theory_chart_heatstroke: "Heatstroke",
                theory_chart_hyponatremia: "Hyponatremia",
                theory_chart_y_axis_1: "Explains May 10 event",
                theory_chart_y_axis_2: "Matches autopsy findings",
                theory_chart_y_axis_3: "Integrates lifestyle risks",
            }
        };

        function switchLanguage(lang) {
            document.documentElement.lang = lang === 'zh' ? 'zh-Hant' : 'en';
            
            const elements = document.querySelectorAll('[data-lang-key]');
            elements.forEach(el => {
                const key = el.dataset.langKey;
                if (translations[lang][key]) {
                    el.innerHTML = translations[lang][key];
                }
            });

            updateCharts(lang);

            document.getElementById('lang-btn-zh').classList.toggle('active', lang === 'zh');
            document.getElementById('lang-btn-en').classList.toggle('active', lang === 'en');
        }

        function updateCharts(lang) {
            if (equagesicChartInstance) equagesicChartInstance.destroy();
            if (theoryComparisonChartInstance) theoryComparisonChartInstance.destroy();
            
            const chartJsTooltip = {
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                if (Array.isArray(label)) {
                                  return label.join(' ');
                                } else {
                                  return label;
                                }
                            }
                        }
                    }
                }
            };

            const equagesicData = {
                labels: [translations[lang].equagesic_aspirin, translations[lang].equagesic_meprobamate],
                datasets: [{
                    label: translations[lang].equagesic_chart_title,
                    data: [50, 50],
                    backgroundColor: ['#00A1B4', '#48C2D4'],
                    borderColor: '#0F172A',
                    borderWidth: 4,
                    hoverOffset: 4
                }]
            };
            equagesicChartInstance = new Chart(document.getElementById('equagesicChart'), {
                type: 'doughnut',
                data: equagesicData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        ...chartJsTooltip.plugins,
                        legend: {
                            position: 'bottom',
                            labels: { color: '#cbd5e1', font: { size: 12 } }
                        }
                    }
                }
            });

            const theoryComparisonData = {
                labels: [
                    translations[lang].theory_chart_y_axis_1, 
                    translations[lang].theory_chart_y_axis_2, 
                    translations[lang].theory_chart_y_axis_3
                ],
                datasets: [
                    {
                        label: translations[lang].theory_chart_allergy,
                        data: [1, 3, 2],
                        backgroundColor: '#D4F4F8',
                        borderColor: '#8EDCE6',
                        borderWidth: 1
                    },
                    {
                        label: translations[lang].theory_chart_heatstroke,
                        data: [6, 5, 7],
                        backgroundColor: '#48C2D4',
                        borderColor: '#00A1B4',
                        borderWidth: 1
                    },
                    {
                        label: translations[lang].theory_chart_hyponatremia,
                        data: [10, 10, 10],
                        backgroundColor: '#00A1B4',
                        borderColor: '#007A8A',
                        borderWidth: 1
                    }
                ]
            };
            theoryComparisonChartInstance = new Chart(document.getElementById('theoryComparisonChart'), {
                type: 'bar',
                data: theoryComparisonData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 10,
                            title: {
                                display: true,
                                text: translations[lang].theory_chart_x_axis,
                                color: '#94a3b8'
                            },
                            ticks: { color: '#94a3b8' },
                            grid: { color: 'rgba(148, 163, 184, 0.2)' }
                        },
                        y: {
                            ticks: { color: '#cbd5e1', font: { size: 14 } },
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        ...chartJsTooltip.plugins,
                        legend: {
                            position: 'top',
                            labels: { color: '#cbd5e1', font: { size: 14 } }
                        },
                        title: {
                            display: true,
                            text: translations[lang].theory_chart_title,
                            color: '#FFFFFF',
                            font: { size: 18, weight: 'bold' }
                        }
                    }
                }
            });
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            switchLanguage('zh');
        });
    </script>
</body>
</html>
